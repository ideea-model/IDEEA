<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>IDEEA: Electric power sector model • IDEEA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="IDEEA: Electric power sector model">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-1FN9MK20PS"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1FN9MK20PS');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IDEEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.49.00.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/IDEEA.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/about.html">About</a></li>
    <li><a class="dropdown-item" href="../articles/help.html">Help</a></li>
    <li><a class="dropdown-item" href="../articles/install.html">Installation</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>IDEEA model components</h6></li>
    <li><a class="dropdown-item" href="../articles/regions.html">—Regions</a></li>
    <li><a class="dropdown-item" href="../articles/calendars.html">—Time</a></li>
    <li><a class="dropdown-item" href="../articles/data.html">—Datasets</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>IDEEA model sectors</h6></li>
    <li><a class="dropdown-item" href="../articles/energy.html">—Energy</a></li>
    <li><a class="dropdown-item" href="../articles/electricity.html">—Electricity</a></li>
    <li><a class="dropdown-item" href="../articles/transmission.html">—Transmission</a></li>
    <li><a class="dropdown-item" href="../articles/hydrogen.html">—Hydrogen</a></li>
    <li><a class="dropdown-item" href="../articles/ccus.html">—CCUS</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Sectors in development</h6></li>
    <li><a class="dropdown-item" href="../articles/transport.html">—Transport</a></li>
    <li><a class="dropdown-item" href="../articles/buildings.html">—Buildings</a></li>
    <li><a class="dropdown-item" href="../articles/iron_steel.html">—Iron and Stell</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>—Refineries</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>—Cement and Clinker</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Regional models</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>—Karnataka</h6></li>
    <li><a class="dropdown-item" href="../articles/reports.html">—Reports</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>IDEEA in Switch (in work)</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>IDEEA in PyPSA (planned)</h6></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ideea-model/IDEEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>IDEEA: Electric power sector model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ideea-model/IDEEA/blob/HEAD/vignettes/articles/electricity.Rmd" class="external-link"><code>vignettes/articles/electricity.Rmd</code></a></small>
      <div class="d-none name"><code>electricity.Rmd</code></div>
    </div>

    
    
<!-- This vignette should describe steps of building and configuring the IDEEA model from the data available with the package. A reader should understand the model structure, the sources of the data, and main assumptions. -->
<div class="section level2">
<h2 id="configuration">Configuration<a class="anchor" aria-label="anchor" href="#configuration"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set number of regions, currently '5' and '32' are available</span></span>
<span><span class="co"># nreg &lt;- 32</span></span>
<span><span class="va">nreg</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="va">offshore</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># should offshore regions be included</span></span>
<span><span class="va">islands</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># should islands be included</span></span>
<span><span class="va">base_year</span> <span class="op">&lt;-</span> <span class="fl">2019</span> <span class="co"># the first year of the model (base year or `BY`)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">nreg</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">transmission_matrix</span> <span class="op">&lt;-</span> <span class="st">"current"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">nreg</span> <span class="op">==</span> <span class="fl">32</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># transmission_matrix &lt;- "newlines_v01" # ~70 power lines</span></span>
<span>  <span class="co"># transmission_matrix &lt;- "newlines_v02" # ~50 power lines</span></span>
<span>  <span class="va">transmission_matrix</span> <span class="op">&lt;-</span> <span class="st">"newlines_v03"</span> <span class="co"># ~30 power lines</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Only 5 and 32 regions are currently implemented"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># region variable name to use in functions (e.g. `get_ideea_data`)</span></span>
<span><span class="va">regN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"reg"</span>, <span class="va">nreg</span><span class="op">)</span></span>
<span><span class="va">regN_off</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">regN</span>, <span class="st">"_off"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># wind and solar clustering tolerance</span></span>
<span><span class="va">tol_win_cl</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">tol_sol_cl</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/" class="external-link">glue</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># if IDEEA is installed, uncomment this line to load IDEEA</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ideea-model.github.io/IDEEA">IDEEA</a></span><span class="op">)</span></span>
<span><span class="co"># if running from the IDEEA folder without installation</span></span>
<span><span class="co"># devtools::load_all(".")</span></span>
<span><span class="fu"><a href="https://energyRt.org/reference/progress.html" class="external-link">set_progress_bar</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># show_progress_bar(F)</span></span></code></pre></div>
<p>If not done yet, configure your system, editing and saving global
options:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ideea_global_options.html">ideea_global_options</a></span><span class="op">(</span>edit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="regions">Regions<a class="anchor" aria-label="anchor" href="#regions"></a>
</h2>
<!-- A short desc of alternative regional division and how it affects the modeling results/accuracy and computational burden. reference to the `maps` article. -->
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ideea_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ideea_map.html">get_ideea_map</a></span><span class="op">(</span><span class="va">nreg</span>,</span>
<span>  offshore <span class="op">=</span> <span class="va">offshore</span>, islands <span class="op">=</span> <span class="va">islands</span>,</span>
<span>  rename <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ideea_sf</span><span class="op">[</span><span class="va">regN_off</span><span class="op">]</span>, key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">lcm</a></span><span class="op">(</span><span class="fl">4.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="electricity_files/figure-html/regions-1.png" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="time-resolution">Time resolution<a class="anchor" aria-label="anchor" href="#time-resolution"></a>
</h2>
<p>Structure of sub-annual time resolution is done <code>calendar</code>
objects, that specifies levels of nested time-frames (such as ‘ANNUAL’,
‘MONTH’, ‘DAY’, ‘HOUR’, etc. depending on the modeling goals and decided
level of details). This structure of modeled sub-annual time resolution
is assigned by a <code>timetable</code> data.frame with columns named as
used time-frames, as well as ‘slice’ (refers to the lowest level of
‘time-slices’ with unique names, e.g. ‘d001_h15’ indicating the 1st day
of the year and the 15th hour of the day), the ‘share’ column (for the
share of the time-frame in the year), and ‘weight’ (for the weight of
the time-frame in the year, used in sampled calendars).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ideea_modules</span><span class="op">$</span><span class="va">time_tables</span><span class="op">$</span><span class="va">d365_h24</span></span>
<span><span class="co">#&gt;       ANNUAL   YDAY   HOUR    slice        share weight</span></span>
<span><span class="co">#&gt;       &lt;char&gt; &lt;char&gt; &lt;char&gt;   &lt;char&gt;        &lt;num&gt;  &lt;num&gt;</span></span>
<span><span class="co">#&gt;    1: ANNUAL   d001    h00 d001_h00 0.0001141553      1</span></span>
<span><span class="co">#&gt;    2: ANNUAL   d001    h01 d001_h01 0.0001141553      1</span></span>
<span><span class="co">#&gt;    3: ANNUAL   d001    h02 d001_h02 0.0001141553      1</span></span>
<span><span class="co">#&gt;    4: ANNUAL   d001    h03 d001_h03 0.0001141553      1</span></span>
<span><span class="co">#&gt;    5: ANNUAL   d001    h04 d001_h04 0.0001141553      1</span></span>
<span><span class="co">#&gt;   ---                                                  </span></span>
<span><span class="co">#&gt; 8756: ANNUAL   d365    h19 d365_h19 0.0001141553      1</span></span>
<span><span class="co">#&gt; 8757: ANNUAL   d365    h20 d365_h20 0.0001141553      1</span></span>
<span><span class="co">#&gt; 8758: ANNUAL   d365    h21 d365_h21 0.0001141553      1</span></span>
<span><span class="co">#&gt; 8759: ANNUAL   d365    h22 d365_h22 0.0001141553      1</span></span>
<span><span class="co">#&gt; 8760: ANNUAL   d365    h23 d365_h23 0.0001141553      1</span></span></code></pre></div>
<p>This time-table is to define a <code>calendar</code> object, that
also describes the hierarchy of time-frames and sets the sequence of the
time-slices.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the model is defined with the full calendar</span></span>
<span><span class="va">calendar_d365_h24_full</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">calendars</span><span class="op">$</span><span class="va">calendar_d365_h24_full</span></span>
<span></span>
<span><span class="co"># a scenario can be run with a subset of the time-slices</span></span>
<span><span class="va">calendar_d365_h24_subset</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">ideea_modules</span><span class="op">$</span><span class="va">calendars</span><span class="op">$</span><span class="va">calendar_d365_h24_subset_1day_per_month</span></span></code></pre></div>
<p>The model object (described below) must have the
<code>calendar</code> object with all time-frames and time-slices used
in the model. However, scenarios can be solved for a subset of the
time-slices, defined by another <code>calendar</code> object with
sub-set of time-slices. Here we define a calendar with a subset of 1 day
per month and 24 hours per each day. Therefore, the total number of
time-slices in the subset is 12 days * 24 hours = 288 time-slices
(vs. 8760 time-slices in the full calendar).</p>
</div>
<div class="section level2">
<h2 id="commodities">Commodities<a class="anchor" aria-label="anchor" href="#commodities"></a>
</h2>
<p>Commodities are the main objects of the model, representing the goods
and services that are traded in the model. Commodities can be energy
carriers (e.g. electricity, coal, oil, gas, biomass), emissions
(e.g. CO2, NOx, SOx, PM), or other goods and services. Commodities are
defined by their name, description, unit of measure, and time-frame by
the <code>newCommodity</code> function. Some of the commodity-objects
are pre-built in the <code>energy</code> module, and can be loaded from
there. Commodities specific to the electricity model are defined below.
Important features of commodities are their time-frame, and the limit
type (slot <code>@limtype</code>) that defines the balance equation for
the commodity. By default the limit type is set to “LO” (lower bound)
meaning that excess of commodity is allowed, but the deficit is not.
Other options are “UP” (upper bound) and “FX” (equality).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># energy</span></span>
<span><span class="va">ELC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/commodity.html" class="external-link">newCommodity</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"ELC"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Electricity"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"GWh"</span>,</span>
<span>  timeframe <span class="op">=</span> <span class="st">"HOUR"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># emissions</span></span>
<span><span class="va">CO2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/commodity.html" class="external-link">newCommodity</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"CO2"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Carbon emissions"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"kt"</span>,</span>
<span>  timeframe <span class="op">=</span> <span class="st">"ANNUAL"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">NOX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/commodity.html" class="external-link">newCommodity</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"NOX"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Nitrogen oxide emissions NOx"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"kt"</span>,</span>
<span>  timeframe <span class="op">=</span> <span class="st">"ANNUAL"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">SOX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/commodity.html" class="external-link">newCommodity</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"SOX"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Sulfur oxide emissions SOx"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"kt"</span>,</span>
<span>  timeframe <span class="op">=</span> <span class="st">"ANNUAL"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">PM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/commodity.html" class="external-link">newCommodity</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"PM"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Particulate matter (particle pollution)"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"kt"</span>,</span>
<span>  timeframe <span class="op">=</span> <span class="st">"ANNUAL"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">REN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/commodity.html" class="external-link">newCommodity</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"REN"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Generic renewable energy"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"GWh"</span>,</span>
<span>  timeframe <span class="op">=</span> <span class="st">"ANNUAL"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># storing commodities in a repository</span></span>
<span><span class="va">repo_comm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"repo_comm"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Electricity &amp; emissions commodities"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add</span><span class="op">(</span><span class="va">ELC</span>, <span class="va">CO2</span>, <span class="va">NOX</span>, <span class="va">SOX</span>, <span class="va">PM</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="demand-options">Demand options<a class="anchor" aria-label="anchor" href="#demand-options"></a>
</h2>
<p>For the electricity-only model, the electricity is considered as the
final product, and the final demand can be set exogenously via the
<code>demand</code> class. The <code>newDemand</code> function creates
an object of class <code>demand</code> with detailed representation of
the demanded electricity by region, time-slice, and year. The values of
demand without information on the parameter dimension, such as the
region, time-slice, or year are considered default for the non-specified
dimensions, and will be filled-in on the interpolation step of the model
along with the missing years. Therefore it is enough to set values for
the base-year and the last year, if the demand is expected to grow
linearly. The load curve by region in India for 2019 is stored in the
<code>load_2019_MWh</code> dataset, and used in this example as the
base-year demand, extrapolated through the model’s horizon.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># call the load curve by region in 2019 from IDDEA dataset</span></span>
<span><span class="va">load_BY</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ideea_data.html">get_ideea_data</a></span><span class="op">(</span><span class="st">"load_2019_MWh"</span>, nreg <span class="op">=</span> <span class="va">nreg</span>, variable <span class="op">=</span> <span class="st">"MWh"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>GWh <span class="op">=</span> <span class="va">MWh</span> <span class="op">/</span> <span class="fl">1e3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">MWh</span><span class="op">)</span></span>
<span><span class="co"># rename(region = {{regN}})</span></span>
<span></span>
<span><span class="co"># define `demand` object with the historical load curve</span></span>
<span><span class="va">DEMELC_BY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/demand.html" class="external-link">newDemand</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"DEMELC_BY"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Houlry electric demand by region, base-year level"</span>,</span>
<span>  commodity <span class="op">=</span> <span class="st">"ELC"</span>,</span>
<span>  unit <span class="op">=</span> <span class="va">ELC</span><span class="op">@</span><span class="va">unit</span>,</span>
<span>  dem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    region <span class="op">=</span> <span class="va">load_BY</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    <span class="co"># year = load_BY$year, # assign to all years</span></span>
<span>    slice <span class="op">=</span> <span class="va">load_BY</span><span class="op">$</span><span class="va">slice</span>,</span>
<span>    dem <span class="op">=</span> <span class="va">load_BY</span><span class="op">$</span><span class="va">GWh</span> <span class="co"># * dem_adj</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># display first 6 regions</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">load_BY</span>, <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">regN</span><span class="op">)</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">load_BY</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">HOUR</span>, <span class="va">GWh</span>, color <span class="op">=</span> <span class="va">YDAY</span>, group <span class="op">=</span> <span class="va">YDAY</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">365</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">23</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet_wrap(~ get(regN), ncol = floor(nreg / 3), scales = "free_y") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">regN</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"GWh"</span>, x <span class="op">=</span> <span class="st">"hour"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="electricity_files/figure-html/unnamed-chunk-9-1.png" alt="Hourly load by region, 2019 (first six regions)"><p class="caption">
Hourly load by region, 2019 (first six regions)
</p>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"load_2019_{regN}.png"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">9</span>, path <span class="op">=</span> <span class="st">"tmp"</span><span class="op">)</span></span></code></pre></div>
<p>The demand growth is set by another demand-object with linear growth
of the demand in every region, time-slice from zero to 2x the base-year
level by 2050, and 3x by 2070. If the model horizon is longer, the
demand can be extrapolated further.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define demand in several years, e.g. 2020, 2050, 2070,</span></span>
<span><span class="co"># which will be interpolated before solving the model ('interpolation' step)</span></span>
<span><span class="va">load_2x_2050</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">load_BY</span>, year <span class="op">=</span> <span class="fl">2020</span>, GWh <span class="op">=</span> <span class="fl">0.0</span> <span class="op">*</span> <span class="va">GWh</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">load_BY</span>, year <span class="op">=</span> <span class="fl">2050</span>, GWh <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">GWh</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">load_BY</span>, year <span class="op">=</span> <span class="fl">2070</span>, GWh <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">GWh</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">load_BY</span></span>
<span><span class="co">#&gt;          reg5 offshore mainland    slice            datetime MONTH  YDAY  HOUR</span></span>
<span><span class="co">#&gt;        &lt;char&gt;   &lt;lgcl&gt;   &lt;lgcl&gt;   &lt;char&gt;              &lt;POSc&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt;     1:   EAST    FALSE     TRUE d001_h00 2019-01-01 00:00:00     1     1     0</span></span>
<span><span class="co">#&gt;     2:   EAST    FALSE     TRUE d001_h01 2019-01-01 01:00:00     1     1     1</span></span>
<span><span class="co">#&gt;     3:   EAST    FALSE     TRUE d001_h02 2019-01-01 02:00:00     1     1     2</span></span>
<span><span class="co">#&gt;     4:   EAST    FALSE     TRUE d001_h03 2019-01-01 03:00:00     1     1     3</span></span>
<span><span class="co">#&gt;     5:   EAST    FALSE     TRUE d001_h04 2019-01-01 04:00:00     1     1     4</span></span>
<span><span class="co">#&gt;    ---                                                                        </span></span>
<span><span class="co">#&gt; 43796:   WEST    FALSE     TRUE d365_h19 2019-12-31 19:00:00    12   365    19</span></span>
<span><span class="co">#&gt; 43797:   WEST    FALSE     TRUE d365_h20 2019-12-31 20:00:00    12   365    20</span></span>
<span><span class="co">#&gt; 43798:   WEST    FALSE     TRUE d365_h21 2019-12-31 21:00:00    12   365    21</span></span>
<span><span class="co">#&gt; 43799:   WEST    FALSE     TRUE d365_h22 2019-12-31 22:00:00    12   365    22</span></span>
<span><span class="co">#&gt; 43800:   WEST    FALSE     TRUE d365_h23 2019-12-31 23:00:00    12   365    23</span></span>
<span><span class="co">#&gt;           GWh</span></span>
<span><span class="co">#&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt;     1: 10.833</span></span>
<span><span class="co">#&gt;     2: 10.214</span></span>
<span><span class="co">#&gt;     3:  9.974</span></span>
<span><span class="co">#&gt;     4:  9.808</span></span>
<span><span class="co">#&gt;     5:  9.684</span></span>
<span><span class="co">#&gt;    ---       </span></span>
<span><span class="co">#&gt; 43796: 44.449</span></span>
<span><span class="co">#&gt; 43797: 41.124</span></span>
<span><span class="co">#&gt; 43798: 38.602</span></span>
<span><span class="co">#&gt; 43799: 36.833</span></span>
<span><span class="co">#&gt; 43800: 36.831</span></span>
<span></span>
<span><span class="co"># define the second demand object with the load growth</span></span>
<span><span class="va">DEMELC_2X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/demand.html" class="external-link">newDemand</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"DEMELC_2X"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Additional demand growth, proportional to the current load"</span>,</span>
<span>  commodity <span class="op">=</span> <span class="st">"ELC"</span>,</span>
<span>  unit <span class="op">=</span> <span class="va">ELC</span><span class="op">@</span><span class="va">unit</span>,</span>
<span>  dem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    region <span class="op">=</span> <span class="va">load_2x_2050</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    year <span class="op">=</span> <span class="va">load_2x_2050</span><span class="op">$</span><span class="va">year</span>,</span>
<span>    slice <span class="op">=</span> <span class="va">load_2x_2050</span><span class="op">$</span><span class="va">slice</span>, <span class="co"># comment to assign to all hours</span></span>
<span>    dem <span class="op">=</span> <span class="va">load_2x_2050</span><span class="op">$</span><span class="va">GWh</span> <span class="co"># * dem_adj</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Alternative demand-objects can be created and added to the model
before interpolation/solution to represent different scenarios or policy
options.<br>
Another ways to set the demand in the model also available. For example,
<code>export</code> objects define the potential external demand with
levels and also the price of the electricity. If other sectors are
modeled, they can also set the demand for electricity,
e.g. <code>transport</code> or <code>industry</code> modules.</p>
</div>
<div class="section level2">
<h2 id="supply-resources">Supply &amp; resources<a class="anchor" aria-label="anchor" href="#supply-resources"></a>
</h2>
<p>While demand objects set the final demand commodity (<code>ELC</code>
in this example), the supply objects define the sources of primary
commodities (e.g. coal, gas, oil, biomass, nuclear, renewable energy
sources) that are used in the production of the final or interim
products. The resources used in the electricity model has been already
defined in the <code>energy</code> module, and can be loaded from there.
Another way to introduce a supply of a commodity to the model is
<code>import</code> from another region or from outside the model
regions (“The Rest of the World”, ROW). For every tradable energy
commodity we defined the <code>import</code> with higher than domestic
supply price to ensure that the domestic supply is used first and extend
the availability of the commodities’ supply beyond the domestic
resources – essencial for long-term planning.</p>
<div class="section level3">
<h3 id="primary-energy">Primary energy<a class="anchor" aria-label="anchor" href="#primary-energy"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import energy supply module</span></span>
<span><span class="va">energy_module</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">energy</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># check if the module is available for the requested number of regions</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rlang.r-lib.org/reference/is_empty.html" class="external-link">is_empty</a></span><span class="op">(</span><span class="va">energy_module</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"ideea_modules$energy is not available for "</span>, <span class="va">nreg</span>, <span class="st">" regions"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># define repository for energy supply and resources</span></span>
<span><span class="va">repo_supply</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"repo_supply"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Energy supply (markets)"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add</span><span class="op">(</span> <span class="co"># import objects from energy module</span></span>
<span>    <span class="co"># coal</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">COA</span>, <span class="co"># coal commodity</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">SUP_COA</span>, <span class="co"># coal domestic supply</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">IMP_COA</span>, <span class="co"># coal import</span></span>
<span>    <span class="co"># natural gas</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">GAS</span>, <span class="co"># natural gas commodity</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">SUP_GAS</span>, <span class="co"># natural gas domestic supply</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">IMP_GAS</span>, <span class="co"># natural gas import</span></span>
<span>    <span class="co"># oil</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">OIL</span>, <span class="co"># oil commodity</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">SUP_OIL</span>, <span class="co"># oil domestic supply by region</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">IMP_OIL</span>, <span class="co"># oil import</span></span>
<span>    <span class="co"># biomass</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">BIO</span>, <span class="co"># biomass commodity</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">RES_BIO</span>, <span class="co"># domestic resource of biomass</span></span>
<span>    <span class="co"># nuclear</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">NUC</span>, <span class="co"># nuclear fuel commodity</span></span>
<span>    <span class="va">energy_module</span><span class="op">$</span><span class="va">IMP_NUC</span>, <span class="co"># Nuclear fuel international market</span></span>
<span>    <span class="co"># CCS storage potential (separate repo, see below)</span></span>
<span>    <span class="co"># energy_module$CO2SINK, # stored CO2 commodity</span></span>
<span>    <span class="co"># energy_module$RES_CO2SINK, # CO2 storage potential</span></span>
<span>    <span class="co">#</span></span>
<span>    <span class="va">REN</span>, <span class="co"># all type of non-fuel (renewable) energy</span></span>
<span>    <span class="fu"><a href="https://energyRt.org/reference/sypply.html" class="external-link">newSupply</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="st">"RES_REN"</span>,</span>
<span>      commodity <span class="op">=</span> <span class="st">"REN"</span>,</span>
<span>      desc <span class="op">=</span> <span class="st">"An artificial commodity to represent all renewable energy"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    overwrite <span class="op">=</span> <span class="cn">F</span> <span class="co"># restrict duplicate objects</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">repo_supply</span><span class="op">)</span></span>
<span><span class="co">#&gt; commodity    import    supply </span></span>
<span><span class="co">#&gt;         6         4         5</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">repo_supply</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "COA"     "SUP_COA" "IMP_COA" "GAS"     "SUP_GAS" "IMP_GAS" "OIL"    </span></span>
<span><span class="co">#&gt;  [8] "SUP_OIL" "IMP_OIL" "BIO"     "RES_BIO" "NUC"     "IMP_NUC" "REN"    </span></span>
<span><span class="co">#&gt; [15] "RES_REN"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="carbon-storage">Carbon storage<a class="anchor" aria-label="anchor" href="#carbon-storage"></a>
</h3>
<p>The geological potential for carbon storage by region is defined in
<code>CCUS</code> document, stored in IDEEA modules.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import CCS potential from energy supply module</span></span>
<span></span>
<span><span class="va">repo_geoccs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"repo_ccs"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Carbon storage potential by region"</span>,</span>
<span>  <span class="co"># CCS storage potential</span></span>
<span>  <span class="va">energy_module</span><span class="op">$</span><span class="va">CO2SINK</span>, <span class="co"># stored CO2 commodity</span></span>
<span>  <span class="va">energy_module</span><span class="op">$</span><span class="va">RES_CO2SINK</span> <span class="co"># CO2 storage potential</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">repo_geoccs</span><span class="op">)</span></span>
<span><span class="co">#&gt; commodity    supply </span></span>
<span><span class="co">#&gt;         1         1</span></span>
<span></span>
<span><span class="co"># clean-up</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">energy_module</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="capacity-factors">Capacity factors<a class="anchor" aria-label="anchor" href="#capacity-factors"></a>
</h2>
<p>The availability of renewable energy sources (solar, wind, hydro) is
defined by the capacity factors (CF) that represent the share of the
potential energy that can be harvested in a given time-frame per unit of
a generator capacity. The capacity factors are defined by the
<code>weather</code> objects with the time-frame of the weather data
(e.g. “HOUR” for hourly data, “YDAY” for daily data). The weather data
can be obtained from the external sources (e.g. NREL, MERRA2, ERA5),
some are saved in the IDEEA datasets. The capacity factors can be
defined for the whole region, or for the specific locations.</p>
<div class="section level3">
<h3 id="solar">Solar<a class="anchor" aria-label="anchor" href="#solar"></a>
</h3>
<p>This example implements the solar capacity factors for the regions of
India, based on the MERRA2 dataset. The capacity factors are defined for
the tilted tracking system (<code>tl</code>), estimated with
<code>merra2ools</code> package.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get clustered capacity factors from `ideea_extra` dataset</span></span>
<span><span class="co"># if the data with requested parameters is not pre-saved, </span></span>
<span><span class="co"># it will be calculated from the raw MERRA2 data using `merra2ools` package</span></span>
<span><span class="co"># and cashed in the `ideea_extra` dataset</span></span>
<span><span class="va">solar_cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ideea_cf.html">get_ideea_cf</a></span><span class="op">(</span><span class="st">"sol"</span>, nreg <span class="op">=</span> <span class="va">nreg</span>, year <span class="op">=</span> <span class="fl">2019</span>, tol <span class="op">=</span> <span class="va">tol_sol_cl</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading capacity factors data from:</span></span>
<span><span class="co">#&gt;    D:/Dropbox/projects/ideea_extra//merra2/cf_sol_r5_TOL05_d365_h24_2019.fst </span></span>
<span><span class="co">#&gt;    Maximum number of clusters per region: 3</span></span>
<span><span class="co"># get map of solar clusters</span></span>
<span><span class="va">ideea_sol_cl_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ideea_cl_sf.html">get_ideea_cl_sf</a></span><span class="op">(</span><span class="st">"sol"</span>, nreg <span class="op">=</span> <span class="va">nreg</span>, tol <span class="op">=</span> <span class="va">tol_sol_cl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># filter out offshore regions</span></span>
<span><span class="va">solar_cf</span> <span class="op">&lt;-</span> <span class="va">solar_cf</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"_off$"</span>, <span class="va">solar_cf</span><span class="op">[[</span><span class="va">regN_off</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">solar_cf</span><span class="op">$</span><span class="va">cluster</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span></span>
<span><span class="co"># maximum number of clusters:</span></span>
<span><span class="va">sol_clust_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">solar_cf</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span> </span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">sol_clust_max</span> <span class="op">&lt;</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sol_clust_digits</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># parameter used in functions</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">sol_clust_max</span> <span class="op">&lt;</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sol_clust_digits</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># parameter used in functions</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="va">sol_clust_max</span> <span class="op">&lt;</span> <span class="fl">10000</span><span class="op">)</span> <span class="co"># maximum clusters per region</span></span>
<span><span class="va">sol_clust_digits</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="co"># parameter used in functions</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># rm(sol_clust_max)</span></span>
<span></span>
<span><span class="co"># create repository to store solar capacity factors (weather objects)</span></span>
<span><span class="va">WSOL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Solar capacity factors"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create weather object for every cluster in a loop and store in the repository</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">solar_cf</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># select data for the cluster</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">solar_cf</span>, <span class="va">cluster</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span></span>
<span>  <span class="co"># create weather object</span></span>
<span>  <span class="va">WSOL_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newWeather.html" class="external-link">newWeather</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="../reference/name_with_cluster.html">name_with_cluster</a></span><span class="op">(</span><span class="st">"WSOL_CL"</span>, <span class="va">i</span>, ndigits <span class="op">=</span> <span class="va">sol_clust_digits</span><span class="op">)</span>,</span>
<span>    desc <span class="op">=</span> <span class="fu"><a href="../reference/name_with_cluster.html">name_with_cluster</a></span><span class="op">(</span></span>
<span>      <span class="st">"Solar capacity factors, tilted tracking system (tl), cluster "</span>, <span class="va">i</span></span>
<span>    <span class="op">)</span>,</span>
<span>    region <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    timeframe <span class="op">=</span> <span class="st">"HOUR"</span>,</span>
<span>    weather <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      region <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      slice <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">slice</span>,</span>
<span>      <span class="co"># year = NA # all years</span></span>
<span>      wval <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">scf_tl</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># add weather object to the repository</span></span>
<span>  <span class="va">WSOL</span> <span class="op">&lt;-</span> <span class="fu">add</span><span class="op">(</span><span class="va">WSOL</span>, <span class="va">WSOL_i</span><span class="op">)</span></span>
<span>  <span class="co"># clean-up</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">WSOL_i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># check the repository</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">WSOL</span><span class="op">)</span> </span>
<span><span class="co">#&gt; weather </span></span>
<span><span class="co">#&gt;       3</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">WSOL</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "WSOL_CL01" "WSOL_CL02" "WSOL_CL03"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="wind">Wind<a class="anchor" aria-label="anchor" href="#wind"></a>
</h3>
<p>The wind capacity factors are defined for the regions of India, based
on the MERRA2 dataset. The capacity factors are estimated for the 100m
height (<code>wcf100m</code>) with <code>merra2ools</code> package, the
data for 5 regions is saved in <code>ideea_data</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get clustered capacity factors from `ideea_extra` dataset</span></span>
<span><span class="va">wind_cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ideea_cf.html">get_ideea_cf</a></span><span class="op">(</span><span class="st">"win"</span>, nreg <span class="op">=</span> <span class="va">nreg</span>, year <span class="op">=</span> <span class="fl">2019</span>, tol <span class="op">=</span> <span class="va">tol_win_cl</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading capacity factors data from:</span></span>
<span><span class="co">#&gt;    D:/Dropbox/projects/ideea_extra//merra2/cf_win_r5_TOL05_d365_h24_2019.fst </span></span>
<span><span class="co">#&gt;    Maximum number of clusters per region: 40</span></span>
<span><span class="co"># get map of wind clusters</span></span>
<span><span class="va">ideea_win_cl_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ideea_cl_sf.html">get_ideea_cl_sf</a></span><span class="op">(</span><span class="st">"win"</span>, nreg <span class="op">=</span> <span class="va">nreg</span>, tol <span class="op">=</span> <span class="va">tol_win_cl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># maximum number of clusters:</span></span>
<span><span class="va">win_clust_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">wind_cf</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span> </span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">win_clust_max</span> <span class="op">&lt;</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">win_clust_digits</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># parameter used in functions</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">sol_clust_max</span> <span class="op">&lt;</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">win_clust_digits</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># parameter used in functions</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="va">sol_clust_max</span> <span class="op">&lt;</span> <span class="fl">10000</span><span class="op">)</span> <span class="co"># maximum clusters per region</span></span>
<span><span class="va">win_clust_digits</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="co"># parameter used in functions</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># rm(win_clust_max)</span></span></code></pre></div>
<p>Notation: WIN - onshore wind WIF - offshore wind WIND - both, onshore
and offshore wind</p>
<div class="section level4">
<h4 id="onshore">Onshore<a class="anchor" aria-label="anchor" href="#onshore"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># repository to store onshore wind capacity factors (weather objects)</span></span>
<span><span class="va">WWIN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Onshore wind capacity factors"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create weather object for every cluster in a loop and store in the repository</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">wind_cf</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">wind_cf</span>, <span class="va">cluster</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"_off"</span>, <span class="va">wind_cf</span><span class="op">[[</span><span class="va">regN_off</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># stop()</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="kw">next</span></span>
<span>  <span class="va">WWIN_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newWeather.html" class="external-link">newWeather</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="../reference/name_with_cluster.html">name_with_cluster</a></span><span class="op">(</span><span class="st">"WWIN_CL"</span>, <span class="va">i</span>, ndigits <span class="op">=</span> <span class="va">win_clust_digits</span><span class="op">)</span>,</span>
<span>    desc <span class="op">=</span> <span class="fu"><a href="../reference/name_with_cluster.html">name_with_cluster</a></span><span class="op">(</span></span>
<span>      <span class="st">"Onshore wind 100m height capacity factors, cluster "</span>, <span class="va">i</span></span>
<span>    <span class="op">)</span>,</span>
<span>    region <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    timeframe <span class="op">=</span> <span class="st">"HOUR"</span>,</span>
<span>    weather <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      region <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      slice <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">slice</span>,</span>
<span>      <span class="co"># year = NA # all years</span></span>
<span>      wval <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">wcf_100m</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">WWIN</span> <span class="op">&lt;-</span> <span class="fu">add</span><span class="op">(</span><span class="va">WWIN</span>, <span class="va">WWIN_i</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">WWIN_i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Check the repository</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">WWIN</span><span class="op">)</span></span>
<span><span class="co">#&gt; weather </span></span>
<span><span class="co">#&gt;      40</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">WWIN</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "WWIN_CL01" "WWIN_CL02" "WWIN_CL03" "WWIN_CL04" "WWIN_CL05" "WWIN_CL06"</span></span>
<span><span class="co">#&gt;  [7] "WWIN_CL07" "WWIN_CL08" "WWIN_CL09" "WWIN_CL10" "WWIN_CL11" "WWIN_CL12"</span></span>
<span><span class="co">#&gt; [13] "WWIN_CL13" "WWIN_CL14" "WWIN_CL15" "WWIN_CL16" "WWIN_CL17" "WWIN_CL18"</span></span>
<span><span class="co">#&gt; [19] "WWIN_CL19" "WWIN_CL20" "WWIN_CL21" "WWIN_CL22" "WWIN_CL23" "WWIN_CL24"</span></span>
<span><span class="co">#&gt; [25] "WWIN_CL25" "WWIN_CL26" "WWIN_CL27" "WWIN_CL28" "WWIN_CL29" "WWIN_CL30"</span></span>
<span><span class="co">#&gt; [31] "WWIN_CL31" "WWIN_CL32" "WWIN_CL33" "WWIN_CL34" "WWIN_CL35" "WWIN_CL36"</span></span>
<span><span class="co">#&gt; [37] "WWIN_CL37" "WWIN_CL38" "WWIN_CL39" "WWIN_CL40"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="offshore">Offshore<a class="anchor" aria-label="anchor" href="#offshore"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># repository to store offshore wind capacity factors (weather objects)</span></span>
<span><span class="va">WWIF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Offshore wind capacity factors"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create weather object for every cluster in a loop and store in the repository</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">wind_cf</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">wind_cf</span>, <span class="va">cluster</span> <span class="op">==</span> <span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"_off"</span>, <span class="va">wind_cf</span><span class="op">[[</span><span class="va">regN_off</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="kw">next</span></span>
<span>  <span class="co"># stop()</span></span>
<span>  <span class="va">WWIF_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newWeather.html" class="external-link">newWeather</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="../reference/name_with_cluster.html">name_with_cluster</a></span><span class="op">(</span><span class="st">"WWIF_CL"</span>, <span class="va">i</span>, ndigits <span class="op">=</span> <span class="va">win_clust_digits</span><span class="op">)</span>,</span>
<span>    desc <span class="op">=</span> <span class="fu"><a href="../reference/name_with_cluster.html">name_with_cluster</a></span><span class="op">(</span></span>
<span>      <span class="st">"Offshore wind 100m height capacity factors, cluster "</span>, <span class="va">i</span>, </span>
<span>      ndigits <span class="op">=</span> <span class="va">win_clust_digits</span></span>
<span>    <span class="op">)</span>,</span>
<span>    region <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    timeframe <span class="op">=</span> <span class="st">"HOUR"</span>,</span>
<span>    weather <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      region <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      slice <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">slice</span>,</span>
<span>      <span class="co"># year = NA # all years</span></span>
<span>      wval <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">wcf_100m</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">WWIF</span> <span class="op">&lt;-</span> <span class="fu">add</span><span class="op">(</span><span class="va">WWIF</span>, <span class="va">WWIF_i</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">WWIF_i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Check the repository</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">WWIF</span><span class="op">)</span></span>
<span><span class="co">#&gt; weather </span></span>
<span><span class="co">#&gt;      12</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">WWIF</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "WWIF_CL01" "WWIF_CL02" "WWIF_CL03" "WWIF_CL04" "WWIF_CL05" "WWIF_CL06"</span></span>
<span><span class="co">#&gt;  [7] "WWIF_CL07" "WWIF_CL08" "WWIF_CL09" "WWIF_CL10" "WWIF_CL11" "WWIF_CL12"</span></span>
<span><span class="co"># WWIF@data$WWIF_CL01</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="hydro">Hydro<a class="anchor" aria-label="anchor" href="#hydro"></a>
</h3>
<p>The hydro capacity factors are based on the official country-wide
hourly data for India in 2013. This simplification is used to
demonstrate the model’s capabilities and can be replaced with more
detailed data if available.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The data is stored in the IDEEA package dataset</span></span>
<span><span class="co"># ideea_data$hydro_hourly_cf_2013 - raw data</span></span>
<span><span class="va">hydro_cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ideea_data.html">get_ideea_data</a></span><span class="op">(</span><span class="st">"hydro_hourly_cf_2013"</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>slice <span class="op">=</span> <span class="fu">dtm2tsl</span><span class="op">(</span><span class="va">datetime</span><span class="op">)</span>, .after <span class="op">=</span> <span class="st">"datetime"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">WHYD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newWeather.html" class="external-link">newWeather</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"WHYD"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Hydro CUF"</span>,</span>
<span>  timeframe <span class="op">=</span> <span class="st">"HOUR"</span>,</span>
<span>  weather <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    <span class="co"># region = NA, # same for all regions</span></span>
<span>    slice <span class="op">=</span> <span class="va">hydro_cf</span><span class="op">$</span><span class="va">slice</span>,</span>
<span>    <span class="co"># year = NA # same for all years</span></span>
<span>    wval <span class="op">=</span> <span class="va">hydro_cf</span><span class="op">$</span><span class="va">cf</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="generating-technologies">Generating technologies<a class="anchor" aria-label="anchor" href="#generating-technologies"></a>
</h2>
<p>The pre-existing capacity of power generation can be defined as
groups of technologies, aggregated by the primary fuel type and other
technological features, such as the efficiency, the costs, the lifetime,
emissions, etc. In this example we use open-source datasets from WRI
with some up-to-date corrections to represent the existing capacity of
the power plants in India by the model regions and primary fuels. While
the capacity is taken from the open WRI dataset, the technology
parameters are collected by the IDEEA group, and have been used to
define technology objects in the <code>techs</code> module
(<code>ideea_modules$techs</code>).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get WRI data for the existing capacity, aggregated by region and primary fuel</span></span>
<span><span class="va">cap_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ideea_data.html">get_ideea_data</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"generators_wri"</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"primary_fuel"</span>, <span class="st">"capacity_mw"</span><span class="op">)</span>,</span>
<span>  nreg <span class="op">=</span> <span class="va">nreg</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">capacity_mw</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># drop zeros</span></span>
<span></span>
<span><span class="co"># get updated summary data for selected fuel type, 2020, aggregated by region</span></span>
<span><span class="va">cap_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ideea_data.html">get_ideea_data</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"generators_2020"</span>,</span>
<span>  nreg <span class="op">=</span> <span class="va">nreg</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Solar"</span>, <span class="st">"Wind"</span>, <span class="st">"Biomass"</span>, <span class="st">"Small Hydro"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># reshape the table in long format</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span> </span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Solar"</span>, <span class="st">"Wind"</span>, <span class="st">"Biomass"</span>, <span class="st">"Small Hydro"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"primary_fuel"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"capacity_mw"</span></span>
<span>  <span class="op">)</span>  </span>
<span></span>
<span><span class="co"># combine the datasets (updating WRI data with the newer capacity of renewables)</span></span>
<span><span class="va">cap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cap_0</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Solar|Wind|Biomass"</span>, <span class="va">primary_fuel</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">cap_1</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># add_reg_off(regN = regN) |&gt;  </span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">regN</span>, <span class="va">regN_off</span>, <span class="st">"offshore"</span>, <span class="st">"primary_fuel"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>capacity_mw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">capacity_mw</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cap_sf</span> <span class="op">&lt;-</span> <span class="va">ideea_sf</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span><span class="va">cap</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">primary_fuel</span><span class="op">)</span>, <span class="va">capacity_mw</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(offshore, reg5)`</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ideea_sf</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">capacity_mw</span> <span class="op">/</span> <span class="fl">1e3</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">cap_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span>, name <span class="op">=</span> <span class="st">"GW"</span>, trans <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">primary_fuel</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    <span class="co"># panel.background = element_rect(fill = "aliceblue"),</span></span>
<span>    <span class="co"># panel.grid = element_line(color = "white", size = 0.8),</span></span>
<span>    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># a</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"tmp/installed_capacity.png"</span>, <span class="va">a</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  scale <span class="op">=</span> <span class="fl">1.25</span></span>
<span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="electricity_files/figure-html/unnamed-chunk-18-1.png" alt="Existing capacity maps (WRI, 2021)"><p class="caption">
Existing capacity maps (WRI, 2021)
</p>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cap</span><span class="op">$</span><span class="va">primary_fuel</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Biomass"     "Coal"        "Hydro"       "Small Hydro" "Solar"      </span></span>
<span><span class="co">#&gt; [6] "Wind"        "Gas"         "Nuclear"     "Oil"</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># summary table</span></span>
<span><span class="va">cap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">primary_fuel</span>, <span class="va">offshore</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>capacity_GW <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">capacity_mw</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e3</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">capacity_GW</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"Installed capacity by primary fuel type in 2020"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Installed capacity by primary fuel type in 2020</caption>
<thead><tr class="header">
<th align="left">primary_fuel</th>
<th align="left">offshore</th>
<th align="right">capacity_GW</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Coal</td>
<td align="left">FALSE</td>
<td align="right">204.91922</td>
</tr>
<tr class="even">
<td align="left">Hydro</td>
<td align="left">FALSE</td>
<td align="right">45.56147</td>
</tr>
<tr class="odd">
<td align="left">Wind</td>
<td align="left">FALSE</td>
<td align="right">38.61986</td>
</tr>
<tr class="even">
<td align="left">Solar</td>
<td align="left">FALSE</td>
<td align="right">37.55065</td>
</tr>
<tr class="odd">
<td align="left">Gas</td>
<td align="left">FALSE</td>
<td align="right">24.94751</td>
</tr>
<tr class="even">
<td align="left">Biomass</td>
<td align="left">FALSE</td>
<td align="right">10.23201</td>
</tr>
<tr class="odd">
<td align="left">Nuclear</td>
<td align="left">FALSE</td>
<td align="right">8.78000</td>
</tr>
<tr class="even">
<td align="left">Small Hydro</td>
<td align="left">FALSE</td>
<td align="right">4.60707</td>
</tr>
<tr class="odd">
<td align="left">Oil</td>
<td align="left">FALSE</td>
<td align="right">1.68084</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="coal-fired">Coal-fired<a class="anchor" aria-label="anchor" href="#coal-fired"></a>
</h3>
<p>There are several generations of coal-fired power plants, from
sub-critical to supercritical, and ultra-supercritical, with different
efficiencies, costs, and emissions. The existing capacity (stock) of
coal-fired power plants in this example is assumed to be represented by
the <code>ECOASUP</code> technology with average efficiency, which will
linearly retire by 2040. More advanced technologies
(<code>ECOAULT</code>) by vintages (2020, 2030, 2040, 2050) are
available for investment. The technology with carbon capture is defined
the the <em>CCS</em> section below.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Existing capacity</span></span>
<span><span class="va">cap_coa</span> <span class="op">&lt;-</span> <span class="va">cap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Coal"</span>, <span class="va">primary_fuel</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">offshore</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume age-based retirement of 2020 capacity by 2030 is 20%</span></span>
<span><span class="va">cap_coa_2030</span> <span class="op">&lt;-</span> <span class="va">cap_coa</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2030</span>, capacity_mw <span class="op">=</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume further retirement of 2020 capacity by 2040 is 90%</span></span>
<span><span class="va">cap_coa_2040</span> <span class="op">&lt;-</span> <span class="va">cap_coa</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2040</span>, capacity_mw <span class="op">=</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine</span></span>
<span><span class="va">cap_coa</span> <span class="op">&lt;-</span> <span class="va">cap_coa</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_coa_2030</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_coa_2040</span><span class="op">)</span></span>
<span><span class="co"># Note: the existing capacity will be linearly interpolated from 2020 to 2040</span></span>
<span><span class="co"># cap = 0 after 2040</span></span>
<span></span>
<span><span class="co"># load coal technology (assume Super-critical for all existing capacity)</span></span>
<span><span class="va">ECOASUP_2020</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">ECOASUP</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">ECOASUP_2020</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ECOASUP_2020</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "technology"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "energyRt"</span></span>
<span></span>
<span><span class="co"># update base-year technology with preexisting capacity</span></span>
<span><span class="va">ECOASUP_2020</span> <span class="op">&lt;-</span> <span class="va">ECOASUP_2020</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/update.html" class="external-link">update</a></span><span class="op">(</span>capacity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    region <span class="op">=</span> <span class="va">cap_coa</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    year <span class="op">=</span> <span class="va">cap_coa</span><span class="op">$</span><span class="va">year</span>,</span>
<span>    stock <span class="op">=</span> <span class="va">cap_coa</span><span class="op">$</span><span class="va">capacity_mw</span> <span class="op">/</span> <span class="fl">1e3</span> <span class="co"># in GW</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load most advanced coal techs for new investment</span></span>
<span><span class="va">ECOA</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">ECOAULT</span> <span class="op">|&gt;</span> <span class="co"># ultra-super-critical</span></span>
<span>  <span class="co"># add(ideea_modules$techs$ECOASUP$ECOASUP_2030) |&gt;</span></span>
<span>  <span class="fu">add</span><span class="op">(</span><span class="va">ECOASUP_2020</span><span class="op">)</span> <span class="co"># add tech with existing capacity</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ECOA</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ECOAULT_2020" "ECOAULT_2030" "ECOAULT_2040" "ECOAULT_2050" "ECOASUP_2020"</span></span>
<span></span>
<span><span class="va">par_init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># plot two technologies side-by-side</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/draw.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">ECOA</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">ECOASUP_2020</span><span class="op">)</span> <span class="co"># super-critical technology in 2020</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/draw.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">ECOA</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">ECOAULT_2050</span><span class="op">)</span> <span class="co"># ultra-super-critical technology in 2050</span></span></code></pre></div>
<p><img src="electricity_files/figure-html/unnamed-chunk-20-1.png" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="va">par_init</span><span class="op">$</span><span class="va">mfrow</span><span class="op">)</span> <span class="co"># reset to initial settings</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="natural-gas">Natural gas<a class="anchor" aria-label="anchor" href="#natural-gas"></a>
</h3>
<p>There are two key natural gas fired technologies in the model: the
combined cycle gas turbine (CCGT) and the open cycle gas turbine (OCGT).
The existing capacity of gas-fired power plants in this example is
assumed to be represented by the CCGT (<code>ENGCC</code>) technology,
which will linearly retire by 2040. The OCGT technology
(<code>ENGOC</code>) and more advanced vintages of NGCC are available
for investment. The technology with carbon capture is defined the the
<em>CCS</em> section below.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cap_gas</span> <span class="op">&lt;-</span> <span class="va">cap</span> <span class="op">|&gt;</span> <span class="co"># existing capacity</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Gas"</span>, <span class="va">primary_fuel</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">offshore</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume retirement of 2020 capacity by 2030</span></span>
<span><span class="va">cap_gas_2030</span> <span class="op">&lt;-</span> <span class="va">cap_gas</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2030</span>, capacity_mw <span class="op">=</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume retirement of 2020 capacity by 2030</span></span>
<span><span class="va">cap_gas_2040</span> <span class="op">&lt;-</span> <span class="va">cap_gas</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2040</span>, capacity_mw <span class="op">=</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine</span></span>
<span><span class="va">cap_gas</span> <span class="op">&lt;-</span> <span class="va">cap_gas</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_gas_2030</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_gas_2040</span><span class="op">)</span></span>
<span><span class="co"># Note: the existing capacity will be linearly interpolated from 2020 to 2040</span></span>
<span><span class="co"># cap = 0 after 2040</span></span>
<span></span>
<span><span class="co"># load coal technology (assume Super-critical for all existing capacity)</span></span>
<span><span class="va">ENGCC_2020</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">ENGCC</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">ENGCC_2020</span></span>
<span></span>
<span><span class="co"># update base-year technology with preexisting capacity</span></span>
<span><span class="va">ENGCC_2020</span> <span class="op">&lt;-</span> <span class="va">ENGCC_2020</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/update.html" class="external-link">update</a></span><span class="op">(</span>capacity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    region <span class="op">=</span> <span class="va">cap_gas</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    year <span class="op">=</span> <span class="va">cap_gas</span><span class="op">$</span><span class="va">year</span>,</span>
<span>    stock <span class="op">=</span> <span class="va">cap_gas</span><span class="op">$</span><span class="va">capacity_mw</span> <span class="op">/</span> <span class="fl">1e3</span> <span class="co"># in GW</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load most advanced coal techs for new investment</span></span>
<span><span class="va">EGAS</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">ENGCC</span> <span class="op">|&gt;</span> <span class="co"># Combined cycle gas turbine</span></span>
<span>  <span class="fu">add</span><span class="op">(</span><span class="va">ENGCC_2020</span>, overwrite <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># technology with pre-existing capacity</span></span>
<span>  <span class="fu">add</span><span class="op">(</span><span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">ENGOC</span><span class="op">)</span> <span class="co"># open cycle gas turbine</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EGAS</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ENGCC_2020" "ENGCC_2030" "ENGCC_2040" "ENGCC_2050" "ENGOC_2020"</span></span>
<span><span class="co">#&gt; [6] "ENGOC_2030" "ENGOC_2040" "ENGOC_2050"</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/draw.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">EGAS</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">ENGCC_2020</span><span class="op">)</span></span></code></pre></div>
<p><img src="electricity_files/figure-html/cap_gas-1.png" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># draw(EGAS@data$ENGCC_2050)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="solar-1">Solar<a class="anchor" aria-label="anchor" href="#solar-1"></a>
</h3>
<p>The solar technologies are defined for the base-year of the model
with pre-existing capacity from WRI datasets; the new technologies
available for investment are represented by several vintages of solar PV
technologies up to 2050.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># solar capacity in ~2020</span></span>
<span><span class="va">cap_sol</span> <span class="op">&lt;-</span> <span class="va">cap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Solar"</span>, <span class="va">primary_fuel</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume retirement of 2020 capacity by 2030</span></span>
<span><span class="va">cap_sol_2030</span> <span class="op">&lt;-</span> <span class="va">cap_sol</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2030</span>, capacity_mw <span class="op">=</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume further retirement by 2040</span></span>
<span><span class="va">cap_sol_2040</span> <span class="op">&lt;-</span> <span class="va">cap_sol</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2040</span>, capacity_mw <span class="op">=</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine</span></span>
<span><span class="va">cap_sol</span> <span class="op">&lt;-</span> <span class="va">cap_sol</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_sol_2030</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_sol_2040</span><span class="op">)</span></span>
<span><span class="co"># Note: the existing capacity will be linearly interpolated from 2020 to 2040</span></span>
<span><span class="co"># cap = 0 after 2040</span></span>
<span></span>
<span><span class="co"># load repository with solar technologies</span></span>
<span><span class="va">ESOL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span><span class="st">"solar_techs"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">ESOL</span><span class="op">)</span> <span class="co"># repository with solar techs</span></span>
<span><span class="co">#&gt; [1] "repository"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "energyRt"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">ESOL</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ESOL_2020" "ESOL_2030" "ESOL_2040" "ESOL_2050"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">WSOL</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "WSOL_CL01" "WSOL_CL02" "WSOL_CL03"</span></span>
<span></span>
<span><span class="co"># Create technology for every cluster and every vintage</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">w</span> <span class="kw">in</span> <span class="va">WSOL</span><span class="op">@</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span> <span class="co"># CF by clusters</span></span>
<span>  <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cluster.html">get_cluster</a></span><span class="op">(</span><span class="va">w</span><span class="op">@</span><span class="va">name</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">lst_cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># temporary list</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">tec</span> <span class="kw">in</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">ESOL</span><span class="op">@</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span> <span class="co"># vintages</span></span>
<span>    <span class="co"># stop() # use for debug</span></span>
<span>    <span class="co"># update prototype technology</span></span>
<span>    <span class="va">tec_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>      <span class="va">tec</span>,</span>
<span>      name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">tec</span><span class="op">@</span><span class="va">name</span>, <span class="st">"_CL"</span>, <span class="va">cl</span><span class="op">)</span>,</span>
<span>      weather <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        weather <span class="op">=</span> <span class="va">w</span><span class="op">@</span><span class="va">name</span>,</span>
<span>        waf.fx <span class="op">=</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span>,</span>
<span>      input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comm <span class="op">=</span> <span class="st">"REN"</span>, unit <span class="op">=</span> <span class="st">"GWh"</span>, combustion <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="co"># store in list</span></span>
<span>    <span class="va">lst_cl</span><span class="op">[[</span><span class="va">tec_w</span><span class="op">@</span><span class="va">name</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tec_w</span>; <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">tec</span>, <span class="va">tec_w</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># stop()</span></span>
<span>  <span class="co"># make a capacity constraint for each cluster</span></span>
<span>  <span class="va">cluster_GW_max</span> <span class="op">&lt;-</span> <span class="va">ideea_sol_cl_sf</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># ungroup() |&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cluster</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">offshore</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">regN</span>, <span class="st">"cluster"</span>, <span class="st">"MW_max"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">regN</span>, <span class="st">"cluster"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>GW <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">MW_max</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e3</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># check data consistency</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">cluster_GW_max</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="va">w</span><span class="op">@</span><span class="va">region</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">CT_ESOL_cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newConstraint.html" class="external-link">newConstraint</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"CT_ESOL_CL"</span>, <span class="va">cl</span><span class="op">)</span>,</span>
<span>    <span class="co"># desc = "Constraint on total solar plants by cluster",</span></span>
<span>    eq <span class="op">=</span> <span class="st">"&lt;="</span>,</span>
<span>    for.each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      year <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      region <span class="op">=</span> <span class="va">w</span><span class="op">@</span><span class="va">region</span></span>
<span>    <span class="op">)</span>,</span>
<span>    variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      variable <span class="op">=</span> <span class="st">"vTechCap"</span>,</span>
<span>      for.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        tech <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lst_cl</span><span class="op">)</span>,</span>
<span>        years <span class="op">=</span> <span class="cn">NULL</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      region <span class="op">=</span> <span class="va">cluster_GW_max</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      rhs <span class="op">=</span> <span class="va">cluster_GW_max</span><span class="op">$</span><span class="va">GW</span></span>
<span>    <span class="op">)</span>,</span>
<span>    defVal <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>    interpolation <span class="op">=</span> <span class="st">"back.inter.forth"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">ESOL</span> <span class="op">&lt;-</span> <span class="fu">add</span><span class="op">(</span><span class="va">ESOL</span>, <span class="va">lst_cl</span>, <span class="va">CT_ESOL_cl</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">lst_cl</span>, <span class="va">CT_ESOL_cl</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Warning: There was 1 warning in `group_by()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> In argument: `across(c(regN, "cluster"))`.</span></span>
<span><span class="co">#&gt; Caused by warning:</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Using an external vector in selections was deprecated in tidyselect 1.1.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `all_of()` or `any_of()` instead.</span></span>
<span><span class="co">#&gt;   # Was:</span></span>
<span><span class="co">#&gt;   data %&gt;% select(regN)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   # Now:</span></span>
<span><span class="co">#&gt;   data %&gt;% select(all_of(regN))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</span></span>
<span></span>
<span><span class="co"># update base-year technology with preexisting capacity</span></span>
<span><span class="va">ESOL</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">ESOL_2020_CL01</span> <span class="op">&lt;-</span> <span class="va">ESOL</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">ESOL_2020_CL01</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>    capacity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      region <span class="op">=</span> <span class="va">cap_sol</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      year <span class="op">=</span> <span class="va">cap_sol</span><span class="op">$</span><span class="va">year</span>,</span>
<span>      stock <span class="op">=</span> <span class="va">cap_sol</span><span class="op">$</span><span class="va">capacity_mw</span> <span class="op">/</span> <span class="fl">1e3</span> <span class="co"># in GW</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">ESOL</span><span class="op">@</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/draw.html" class="external-link">draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="electricity_files/figure-html/unnamed-chunk-21-1.png" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ESOL</span></span>
<span><span class="co">#&gt; repository 'solar_techs': 15 objects.</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ESOL</span><span class="op">)</span></span>
<span><span class="co">#&gt; constraint technology </span></span>
<span><span class="co">#&gt;          3         12</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="wind-1">Wind<a class="anchor" aria-label="anchor" href="#wind-1"></a>
</h3>
<p>Similarly, the wind technologies are defined for the base-year of the
model with pre-existing capacity from WRI datasets; the new technologies
available for investment are represented by vintages.</p>
<div class="section level4">
<h4 id="onshore-1">Onshore<a class="anchor" aria-label="anchor" href="#onshore-1"></a>
</h4>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># existing capacity</span></span>
<span><span class="va">cap_win</span> <span class="op">&lt;-</span> <span class="va">cap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Wind"</span>, <span class="va">primary_fuel</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># correcting the 2020 base year capacity values for wind.</span></span>
<span></span>
<span><span class="co"># assume retirement of 2020 capacity by 2030</span></span>
<span><span class="va">cap_win_2030</span> <span class="op">&lt;-</span> <span class="va">cap_win</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2030</span>, capacity_mw <span class="op">=</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume further retirement by 2040</span></span>
<span><span class="va">cap_win_2040</span> <span class="op">&lt;-</span> <span class="va">cap_win</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2040</span>, capacity_mw <span class="op">=</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine</span></span>
<span><span class="va">cap_win</span> <span class="op">&lt;-</span> <span class="va">cap_win</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_win_2030</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_win_2040</span><span class="op">)</span></span>
<span><span class="co"># Note: the existing capacity will be linearly interpolated from 2020 to 2040</span></span>
<span><span class="co"># cap = 0 after 2040</span></span>
<span></span>
<span><span class="co"># load repository with wind technologies</span></span>
<span><span class="va">EWIN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span><span class="st">"wind_turbines"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">EWIN</span><span class="op">)</span> <span class="co"># repository with wind techs</span></span>
<span><span class="co">#&gt; [1] "repository"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "energyRt"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">EWIN</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "EWIN_2020" "EWIN_2030" "EWIN_2040" "EWIN_2050"</span></span>
<span></span>
<span><span class="co"># Create technology for every cluster and every vintage</span></span>
<span><span class="co"># (similar to solar above)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">w</span> <span class="kw">in</span> <span class="va">WWIN</span><span class="op">@</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span> <span class="co"># CF by clusters</span></span>
<span>  <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cluster.html">get_cluster</a></span><span class="op">(</span><span class="va">w</span><span class="op">@</span><span class="va">name</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">lst_cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># temporary list</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">tec</span> <span class="kw">in</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">EWIN</span><span class="op">@</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span> <span class="co"># vintages</span></span>
<span>    <span class="co"># stop() # use for debug</span></span>
<span>    <span class="co"># update prototype technology</span></span>
<span>    <span class="va">tec_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>      <span class="va">tec</span>,</span>
<span>      name <span class="op">=</span> <span class="fu"><a href="../reference/name_with_cluster.html">name_with_cluster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">tec</span><span class="op">@</span><span class="va">name</span>, <span class="st">"_CL"</span><span class="op">)</span>, <span class="va">cl</span><span class="op">)</span>,</span>
<span>      weather <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        weather <span class="op">=</span> <span class="va">w</span><span class="op">@</span><span class="va">name</span>,</span>
<span>        waf.fx <span class="op">=</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span>,</span>
<span>      input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comm <span class="op">=</span> <span class="st">"REN"</span>, unit <span class="op">=</span> <span class="st">"GWh"</span>, combustion <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="co"># store in list</span></span>
<span>    <span class="va">lst_cl</span><span class="op">[[</span><span class="va">tec_w</span><span class="op">@</span><span class="va">name</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tec_w</span>; <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">tec</span>, <span class="va">tec_w</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># stop()</span></span>
<span>  <span class="co"># make a capacity constraint for each cluster</span></span>
<span>  <span class="va">cluster_GW_max</span> <span class="op">&lt;-</span> <span class="va">ideea_win_cl_sf</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># ungroup() |&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cluster</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">offshore</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">regN</span>, <span class="st">"cluster"</span>, <span class="st">"MW_max"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">regN</span>, <span class="st">"cluster"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>GW <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">MW_max</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e3</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># check data consistency</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">cluster_GW_max</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="va">w</span><span class="op">@</span><span class="va">region</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># create capacity constraint</span></span>
<span>  <span class="va">CT_EWIN_CL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newConstraint.html" class="external-link">newConstraint</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"CT_EWIN_CL"</span>, <span class="va">cl</span><span class="op">)</span>,</span>
<span>    <span class="co"># desc = "Constraint on total solar plants by cluster",</span></span>
<span>    eq <span class="op">=</span> <span class="st">"&lt;="</span>,</span>
<span>    for.each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      year <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      region <span class="op">=</span> <span class="va">w</span><span class="op">@</span><span class="va">region</span></span>
<span>    <span class="op">)</span>,</span>
<span>    variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      variable <span class="op">=</span> <span class="st">"vTechCap"</span>,</span>
<span>      for.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        tech <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lst_cl</span><span class="op">)</span>,</span>
<span>        years <span class="op">=</span> <span class="cn">NULL</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      region <span class="op">=</span> <span class="va">cluster_GW_max</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      rhs <span class="op">=</span> <span class="va">cluster_GW_max</span><span class="op">$</span><span class="va">GW</span></span>
<span>    <span class="op">)</span>,</span>
<span>    defVal <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>    interpolation <span class="op">=</span> <span class="st">"back.inter.forth"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">EWIN</span> <span class="op">&lt;-</span> <span class="fu">add</span><span class="op">(</span><span class="va">EWIN</span>, <span class="va">lst_cl</span>, <span class="va">CT_EWIN_CL</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">lst_cl</span>, <span class="va">CT_EWIN_CL</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">EWIN</span></span>
<span><span class="co">#&gt; repository 'wind_turbines': 200 objects.</span></span>
<span></span>
<span><span class="co"># update base-year technology with preexisting capacity</span></span>
<span><span class="co"># (assigning to first clusters, geo-location can be matched later)</span></span>
<span><span class="va">cap_win_exist</span> <span class="op">&lt;-</span> <span class="va">cap_win</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">regN</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>GW_exist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">capacity_mw</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e3</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">regN</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cap_win_exist_to_cluster</span> <span class="op">&lt;-</span> <span class="va">EWIN</span><span class="op">$</span><span class="va">CT_EWIN_CL01</span><span class="op">@</span><span class="va">rhs</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span><span class="va">cap_win_exist</span>, by <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rhs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">cl</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">win_clust_max</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">tname</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/name_with_cluster.html">name_with_cluster</a></span><span class="op">(</span><span class="st">"EWIN_2020_CL"</span>, <span class="va">cl</span>, ndigits <span class="op">=</span> <span class="va">win_clust_digits</span><span class="op">)</span></span>
<span>  <span class="va">cap_win_exist_to_cluster</span><span class="op">[[</span><span class="va">tname</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cap_win_exist_to_cluster</span><span class="op">[[</span><span class="st">"GW_exist"</span><span class="op">]</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">cap_win_exist_to_cluster</span><span class="op">[[</span><span class="st">"diff"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">cap_win_exist_to_cluster</span><span class="op">[[</span><span class="st">"rhs"</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">cap_win_exist_to_cluster</span><span class="op">[[</span><span class="va">tname</span><span class="op">]</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">cap_win_exist_to_cluster</span><span class="op">[[</span><span class="st">"diff"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ii</span> <span class="op">&lt;-</span> <span class="va">cap_win_exist_to_cluster</span><span class="op">[[</span><span class="st">"diff"</span><span class="op">]</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="fl">0</span></span>
<span>    <span class="va">cap_win_exist_to_cluster</span><span class="op">[[</span><span class="va">tname</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">!</span><span class="va">ii</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>      <span class="va">cap_win_exist_to_cluster</span><span class="op">[[</span><span class="st">"rhs"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">!</span><span class="va">ii</span><span class="op">]</span></span>
<span>    <span class="va">cap_win_exist_to_cluster</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">cap_win_exist_to_cluster</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        GW_exist <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="st">"diff"</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>                           <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="st">"diff"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">cap_win_exist_to_cluster</span><span class="op">$</span><span class="va">GW_exist</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">capacity_cl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      region <span class="op">=</span> <span class="va">cap_win_exist_to_cluster</span><span class="op">$</span><span class="va">region</span>,</span>
<span>      year <span class="op">=</span> <span class="va">cap_win_exist_to_cluster</span><span class="op">$</span><span class="va">year</span>,</span>
<span>      stock <span class="op">=</span> <span class="va">cap_win_exist_to_cluster</span><span class="op">[[</span><span class="va">tname</span><span class="op">]</span><span class="op">]</span> <span class="co"># in GW</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">stock</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">EWIN</span><span class="op">@</span><span class="va">data</span><span class="op">[[</span><span class="va">tname</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">EWIN</span><span class="op">@</span><span class="va">data</span><span class="op">[[</span><span class="va">tname</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rspatial.github.io/terra/reference/update.html" class="external-link">update</a></span><span class="op">(</span>capacity <span class="op">=</span> <span class="va">capacity_cl</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">cap_win_exist_to_cluster</span><span class="op">$</span><span class="va">GW_exist</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="kw">break</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EWIN</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] "EWIN_2020_CL01" "EWIN_2030_CL01" "EWIN_2040_CL01" "EWIN_2050_CL01"</span></span>
<span><span class="co">#&gt;   [5] "CT_EWIN_CL01"   "EWIN_2020_CL02" "EWIN_2030_CL02" "EWIN_2040_CL02"</span></span>
<span><span class="co">#&gt;   [9] "EWIN_2050_CL02" "CT_EWIN_CL02"   "EWIN_2020_CL03" "EWIN_2030_CL03"</span></span>
<span><span class="co">#&gt;  [13] "EWIN_2040_CL03" "EWIN_2050_CL03" "CT_EWIN_CL03"   "EWIN_2020_CL04"</span></span>
<span><span class="co">#&gt;  [17] "EWIN_2030_CL04" "EWIN_2040_CL04" "EWIN_2050_CL04" "CT_EWIN_CL04"  </span></span>
<span><span class="co">#&gt;  [21] "EWIN_2020_CL05" "EWIN_2030_CL05" "EWIN_2040_CL05" "EWIN_2050_CL05"</span></span>
<span><span class="co">#&gt;  [25] "CT_EWIN_CL05"   "EWIN_2020_CL06" "EWIN_2030_CL06" "EWIN_2040_CL06"</span></span>
<span><span class="co">#&gt;  [29] "EWIN_2050_CL06" "CT_EWIN_CL06"   "EWIN_2020_CL07" "EWIN_2030_CL07"</span></span>
<span><span class="co">#&gt;  [33] "EWIN_2040_CL07" "EWIN_2050_CL07" "CT_EWIN_CL07"   "EWIN_2020_CL08"</span></span>
<span><span class="co">#&gt;  [37] "EWIN_2030_CL08" "EWIN_2040_CL08" "EWIN_2050_CL08" "CT_EWIN_CL08"  </span></span>
<span><span class="co">#&gt;  [41] "EWIN_2020_CL09" "EWIN_2030_CL09" "EWIN_2040_CL09" "EWIN_2050_CL09"</span></span>
<span><span class="co">#&gt;  [45] "CT_EWIN_CL09"   "EWIN_2020_CL10" "EWIN_2030_CL10" "EWIN_2040_CL10"</span></span>
<span><span class="co">#&gt;  [49] "EWIN_2050_CL10" "CT_EWIN_CL10"   "EWIN_2020_CL11" "EWIN_2030_CL11"</span></span>
<span><span class="co">#&gt;  [53] "EWIN_2040_CL11" "EWIN_2050_CL11" "CT_EWIN_CL11"   "EWIN_2020_CL12"</span></span>
<span><span class="co">#&gt;  [57] "EWIN_2030_CL12" "EWIN_2040_CL12" "EWIN_2050_CL12" "CT_EWIN_CL12"  </span></span>
<span><span class="co">#&gt;  [61] "EWIN_2020_CL13" "EWIN_2030_CL13" "EWIN_2040_CL13" "EWIN_2050_CL13"</span></span>
<span><span class="co">#&gt;  [65] "CT_EWIN_CL13"   "EWIN_2020_CL14" "EWIN_2030_CL14" "EWIN_2040_CL14"</span></span>
<span><span class="co">#&gt;  [69] "EWIN_2050_CL14" "CT_EWIN_CL14"   "EWIN_2020_CL15" "EWIN_2030_CL15"</span></span>
<span><span class="co">#&gt;  [73] "EWIN_2040_CL15" "EWIN_2050_CL15" "CT_EWIN_CL15"   "EWIN_2020_CL16"</span></span>
<span><span class="co">#&gt;  [77] "EWIN_2030_CL16" "EWIN_2040_CL16" "EWIN_2050_CL16" "CT_EWIN_CL16"  </span></span>
<span><span class="co">#&gt;  [81] "EWIN_2020_CL17" "EWIN_2030_CL17" "EWIN_2040_CL17" "EWIN_2050_CL17"</span></span>
<span><span class="co">#&gt;  [85] "CT_EWIN_CL17"   "EWIN_2020_CL18" "EWIN_2030_CL18" "EWIN_2040_CL18"</span></span>
<span><span class="co">#&gt;  [89] "EWIN_2050_CL18" "CT_EWIN_CL18"   "EWIN_2020_CL19" "EWIN_2030_CL19"</span></span>
<span><span class="co">#&gt;  [93] "EWIN_2040_CL19" "EWIN_2050_CL19" "CT_EWIN_CL19"   "EWIN_2020_CL20"</span></span>
<span><span class="co">#&gt;  [97] "EWIN_2030_CL20" "EWIN_2040_CL20" "EWIN_2050_CL20" "CT_EWIN_CL20"  </span></span>
<span><span class="co">#&gt; [101] "EWIN_2020_CL21" "EWIN_2030_CL21" "EWIN_2040_CL21" "EWIN_2050_CL21"</span></span>
<span><span class="co">#&gt; [105] "CT_EWIN_CL21"   "EWIN_2020_CL22" "EWIN_2030_CL22" "EWIN_2040_CL22"</span></span>
<span><span class="co">#&gt; [109] "EWIN_2050_CL22" "CT_EWIN_CL22"   "EWIN_2020_CL23" "EWIN_2030_CL23"</span></span>
<span><span class="co">#&gt; [113] "EWIN_2040_CL23" "EWIN_2050_CL23" "CT_EWIN_CL23"   "EWIN_2020_CL24"</span></span>
<span><span class="co">#&gt; [117] "EWIN_2030_CL24" "EWIN_2040_CL24" "EWIN_2050_CL24" "CT_EWIN_CL24"  </span></span>
<span><span class="co">#&gt; [121] "EWIN_2020_CL25" "EWIN_2030_CL25" "EWIN_2040_CL25" "EWIN_2050_CL25"</span></span>
<span><span class="co">#&gt; [125] "CT_EWIN_CL25"   "EWIN_2020_CL26" "EWIN_2030_CL26" "EWIN_2040_CL26"</span></span>
<span><span class="co">#&gt; [129] "EWIN_2050_CL26" "CT_EWIN_CL26"   "EWIN_2020_CL27" "EWIN_2030_CL27"</span></span>
<span><span class="co">#&gt; [133] "EWIN_2040_CL27" "EWIN_2050_CL27" "CT_EWIN_CL27"   "EWIN_2020_CL28"</span></span>
<span><span class="co">#&gt; [137] "EWIN_2030_CL28" "EWIN_2040_CL28" "EWIN_2050_CL28" "CT_EWIN_CL28"  </span></span>
<span><span class="co">#&gt; [141] "EWIN_2020_CL29" "EWIN_2030_CL29" "EWIN_2040_CL29" "EWIN_2050_CL29"</span></span>
<span><span class="co">#&gt; [145] "CT_EWIN_CL29"   "EWIN_2020_CL30" "EWIN_2030_CL30" "EWIN_2040_CL30"</span></span>
<span><span class="co">#&gt; [149] "EWIN_2050_CL30" "CT_EWIN_CL30"   "EWIN_2020_CL31" "EWIN_2030_CL31"</span></span>
<span><span class="co">#&gt; [153] "EWIN_2040_CL31" "EWIN_2050_CL31" "CT_EWIN_CL31"   "EWIN_2020_CL32"</span></span>
<span><span class="co">#&gt; [157] "EWIN_2030_CL32" "EWIN_2040_CL32" "EWIN_2050_CL32" "CT_EWIN_CL32"  </span></span>
<span><span class="co">#&gt; [161] "EWIN_2020_CL33" "EWIN_2030_CL33" "EWIN_2040_CL33" "EWIN_2050_CL33"</span></span>
<span><span class="co">#&gt; [165] "CT_EWIN_CL33"   "EWIN_2020_CL34" "EWIN_2030_CL34" "EWIN_2040_CL34"</span></span>
<span><span class="co">#&gt; [169] "EWIN_2050_CL34" "CT_EWIN_CL34"   "EWIN_2020_CL35" "EWIN_2030_CL35"</span></span>
<span><span class="co">#&gt; [173] "EWIN_2040_CL35" "EWIN_2050_CL35" "CT_EWIN_CL35"   "EWIN_2020_CL36"</span></span>
<span><span class="co">#&gt; [177] "EWIN_2030_CL36" "EWIN_2040_CL36" "EWIN_2050_CL36" "CT_EWIN_CL36"  </span></span>
<span><span class="co">#&gt; [181] "EWIN_2020_CL37" "EWIN_2030_CL37" "EWIN_2040_CL37" "EWIN_2050_CL37"</span></span>
<span><span class="co">#&gt; [185] "CT_EWIN_CL37"   "EWIN_2020_CL38" "EWIN_2030_CL38" "EWIN_2040_CL38"</span></span>
<span><span class="co">#&gt; [189] "EWIN_2050_CL38" "CT_EWIN_CL38"   "EWIN_2020_CL39" "EWIN_2030_CL39"</span></span>
<span><span class="co">#&gt; [193] "EWIN_2040_CL39" "EWIN_2050_CL39" "CT_EWIN_CL39"   "EWIN_2020_CL40"</span></span>
<span><span class="co">#&gt; [197] "EWIN_2030_CL40" "EWIN_2040_CL40" "EWIN_2050_CL40" "CT_EWIN_CL40"</span></span>
<span><span class="va">EWIN</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">EWIN_2020_CL01</span><span class="op">@</span><span class="va">weather</span></span>
<span><span class="co">#&gt;     weather comm wafc.lo wafc.up wafc.fx waf.lo waf.up waf.fx wafs.lo wafs.up</span></span>
<span><span class="co">#&gt; 1 WWIN_CL01 &lt;NA&gt;      NA      NA      NA     NA     NA      1      NA      NA</span></span>
<span><span class="co">#&gt;   wafs.fx</span></span>
<span><span class="co">#&gt; 1      NA</span></span>
<span><span class="va">EWIN</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">EWIN_2020_CL01</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/draw.html" class="external-link">draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="electricity_files/figure-html/unnamed-chunk-22-1.png" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="offshore-1">Offshore<a class="anchor" aria-label="anchor" href="#offshore-1"></a>
</h4>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">EWIF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span><span class="st">"offshore_wind_turbines"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">EWIF</span><span class="op">)</span> <span class="co"># repository with wind techs</span></span>
<span><span class="co">#&gt; [1] "repository"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "energyRt"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">EWIF</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "EWIF_2020" "EWIF_2030" "EWIF_2040" "EWIF_2050"</span></span>
<span></span>
<span><span class="co"># Create technology for every cluster and every vintage</span></span>
<span><span class="co"># (similar to solar above)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">w</span> <span class="kw">in</span> <span class="va">WWIF</span><span class="op">@</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span> <span class="co"># CF by clusters</span></span>
<span>  <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cluster.html">get_cluster</a></span><span class="op">(</span><span class="va">w</span><span class="op">@</span><span class="va">name</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">lst_cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># temporary list</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">tec</span> <span class="kw">in</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">EWIF</span><span class="op">@</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span> <span class="co"># vintages</span></span>
<span>    <span class="co"># stop() # use for debug</span></span>
<span>    <span class="co"># update prototype technology</span></span>
<span>    <span class="va">tec_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>      <span class="va">tec</span>,</span>
<span>      name <span class="op">=</span> <span class="fu"><a href="../reference/name_with_cluster.html">name_with_cluster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">tec</span><span class="op">@</span><span class="va">name</span>, <span class="st">"_CL"</span><span class="op">)</span>, <span class="va">cl</span><span class="op">)</span>,</span>
<span>      weather <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        weather <span class="op">=</span> <span class="va">w</span><span class="op">@</span><span class="va">name</span>,</span>
<span>        waf.fx <span class="op">=</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span>,</span>
<span>      input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comm <span class="op">=</span> <span class="st">"REN"</span>, unit <span class="op">=</span> <span class="st">"GWh"</span>, combustion <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="co"># store in list</span></span>
<span>    <span class="va">lst_cl</span><span class="op">[[</span><span class="va">tec_w</span><span class="op">@</span><span class="va">name</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tec_w</span>; <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">tec</span>, <span class="va">tec_w</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># stop()</span></span>
<span>  <span class="co"># make a capacity constraint for each cluster</span></span>
<span>  <span class="va">cluster_GW_max</span> <span class="op">&lt;-</span> <span class="va">ideea_win_cl_sf</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># ungroup() |&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cluster</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">offshore</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">regN</span>, <span class="st">"cluster"</span>, <span class="st">"MW_max"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">regN</span>, <span class="st">"cluster"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>GW <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">MW_max</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e3</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># check data consistency</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">cluster_GW_max</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="va">w</span><span class="op">@</span><span class="va">region</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># create capacity constraint</span></span>
<span>  <span class="va">CT_EWIF_CL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newConstraint.html" class="external-link">newConstraint</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"CT_EWIF_CL"</span>, <span class="va">cl</span><span class="op">)</span>,</span>
<span>    <span class="co"># desc = "Constraint on total solar plants by cluster",</span></span>
<span>    eq <span class="op">=</span> <span class="st">"&lt;="</span>,</span>
<span>    for.each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      year <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      region <span class="op">=</span> <span class="va">w</span><span class="op">@</span><span class="va">region</span></span>
<span>    <span class="op">)</span>,</span>
<span>    variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      variable <span class="op">=</span> <span class="st">"vTechCap"</span>,</span>
<span>      for.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        tech <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lst_cl</span><span class="op">)</span>,</span>
<span>        years <span class="op">=</span> <span class="cn">NULL</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      region <span class="op">=</span> <span class="va">cluster_GW_max</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      rhs <span class="op">=</span> <span class="va">cluster_GW_max</span><span class="op">$</span><span class="va">GW</span></span>
<span>    <span class="op">)</span>,</span>
<span>    defVal <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>    interpolation <span class="op">=</span> <span class="st">"back.inter.forth"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">EWIF</span> <span class="op">&lt;-</span> <span class="fu">add</span><span class="op">(</span><span class="va">EWIF</span>, <span class="va">lst_cl</span>, <span class="va">CT_EWIF_CL</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">lst_cl</span>, <span class="va">CT_EWIF_CL</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">EWIF</span><span class="op">)</span></span>
<span><span class="co">#&gt; constraint technology </span></span>
<span><span class="co">#&gt;         12         48</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EWIF</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "EWIF_2020_CL01" "EWIF_2030_CL01" "EWIF_2040_CL01" "EWIF_2050_CL01"</span></span>
<span><span class="co">#&gt;  [5] "CT_EWIF_CL01"   "EWIF_2020_CL02" "EWIF_2030_CL02" "EWIF_2040_CL02"</span></span>
<span><span class="co">#&gt;  [9] "EWIF_2050_CL02" "CT_EWIF_CL02"   "EWIF_2020_CL03" "EWIF_2030_CL03"</span></span>
<span><span class="co">#&gt; [13] "EWIF_2040_CL03" "EWIF_2050_CL03" "CT_EWIF_CL03"   "EWIF_2020_CL04"</span></span>
<span><span class="co">#&gt; [17] "EWIF_2030_CL04" "EWIF_2040_CL04" "EWIF_2050_CL04" "CT_EWIF_CL04"  </span></span>
<span><span class="co">#&gt; [21] "EWIF_2020_CL05" "EWIF_2030_CL05" "EWIF_2040_CL05" "EWIF_2050_CL05"</span></span>
<span><span class="co">#&gt; [25] "CT_EWIF_CL05"   "EWIF_2020_CL06" "EWIF_2030_CL06" "EWIF_2040_CL06"</span></span>
<span><span class="co">#&gt; [29] "EWIF_2050_CL06" "CT_EWIF_CL06"   "EWIF_2020_CL07" "EWIF_2030_CL07"</span></span>
<span><span class="co">#&gt; [33] "EWIF_2040_CL07" "EWIF_2050_CL07" "CT_EWIF_CL07"   "EWIF_2020_CL08"</span></span>
<span><span class="co">#&gt; [37] "EWIF_2030_CL08" "EWIF_2040_CL08" "EWIF_2050_CL08" "CT_EWIF_CL08"  </span></span>
<span><span class="co">#&gt; [41] "EWIF_2020_CL09" "EWIF_2030_CL09" "EWIF_2040_CL09" "EWIF_2050_CL09"</span></span>
<span><span class="co">#&gt; [45] "CT_EWIF_CL09"   "EWIF_2020_CL10" "EWIF_2030_CL10" "EWIF_2040_CL10"</span></span>
<span><span class="co">#&gt; [49] "EWIF_2050_CL10" "CT_EWIF_CL10"   "EWIF_2020_CL11" "EWIF_2030_CL11"</span></span>
<span><span class="co">#&gt; [53] "EWIF_2040_CL11" "EWIF_2050_CL11" "CT_EWIF_CL11"   "EWIF_2020_CL12"</span></span>
<span><span class="co">#&gt; [57] "EWIF_2030_CL12" "EWIF_2040_CL12" "EWIF_2050_CL12" "CT_EWIF_CL12"</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="hydro-1">Hydro<a class="anchor" aria-label="anchor" href="#hydro-1"></a>
</h3>
<p>The decision on development of hydro-power plants normally goes
beyond the optimization of costs, and takes into account the
environmental and social impacts, as well as the availability of the
water resources. The development of hydro-power may take a decade, and
the operational lifetime can go beyond a century. Here we assume that
the existing capacity of hydro-power plants do not retire (until 2100),
the new investments are not available, such projects can be added to the
model as a separate scenario.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cap_hyd</span> <span class="op">&lt;-</span> <span class="va">cap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Hydro"</span>, <span class="va">primary_fuel</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>primary_fuel <span class="op">=</span> <span class="st">"Hydro"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># combining Small with other - assumption (!)</span></span>
<span>  <span class="co"># filter(!offshore) |&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">regN</span>, <span class="va">regN_off</span>, <span class="st">"offshore"</span>, <span class="st">"primary_fuel"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>capacity_mw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">capacity_mw</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">capacity_mw</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume retirement of 2020 capacity by 2030</span></span>
<span><span class="va">cap_hyd_2030</span> <span class="op">&lt;-</span> <span class="va">cap_hyd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2030</span>, capacity_mw <span class="op">=</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume retirement of 2020 capacity by 2030</span></span>
<span><span class="va">cap_hyd_2100</span> <span class="op">&lt;-</span> <span class="va">cap_hyd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2100</span>, capacity_mw <span class="op">=</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine</span></span>
<span><span class="va">cap_hyd</span> <span class="op">&lt;-</span> <span class="va">cap_hyd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_hyd_2030</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_hyd_2100</span><span class="op">)</span></span>
<span><span class="co"># Note: the existing capacity will be linearly interpolated from 2020 to 2040</span></span>
<span><span class="co"># cap = 0 after 2040</span></span>
<span></span>
<span><span class="co"># load base-year technology</span></span>
<span><span class="va">EHYD_2020</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">EHYD</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">EHYD_2020</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">EHYD_2020</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "technology"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "energyRt"</span></span>
<span></span>
<span><span class="co"># update base-year technology with preexisting capacity</span></span>
<span><span class="va">EHYD_2020</span> <span class="op">&lt;-</span> <span class="va">EHYD_2020</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>    capacity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      region <span class="op">=</span> <span class="va">cap_hyd</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      year <span class="op">=</span> <span class="va">cap_hyd</span><span class="op">$</span><span class="va">year</span>,</span>
<span>      stock <span class="op">=</span> <span class="va">cap_hyd</span><span class="op">$</span><span class="va">capacity_mw</span> <span class="op">/</span> <span class="fl">1e3</span> <span class="co"># in GW</span></span>
<span>    <span class="op">)</span>,</span>
<span>    end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>end <span class="op">=</span> <span class="fl">2010</span><span class="op">)</span> <span class="co"># not available for investment</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">EHYD</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">EHYD</span> <span class="op">|&gt;</span> <span class="co">#</span></span>
<span>  <span class="fu">add</span><span class="op">(</span><span class="va">EHYD_2020</span>, overwrite <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># add tech with existing capacity</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EHYD</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "EHYD_2020" "EHYD_2030" "EHYD_2040" "EHYD_2050"</span></span>
<span></span>
<span><span class="co"># add weather factor name and parameter for each technology</span></span>
<span><span class="va">EHYD</span><span class="op">@</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">EHYD</span><span class="op">@</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">tech</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>    <span class="va">tech</span>,</span>
<span>    weather <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>weather <span class="op">=</span> <span class="st">"WHYD"</span>, waf.fx <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comm <span class="op">=</span> <span class="st">"REN"</span>, combustion <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EHYD</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "EHYD_2020" "EHYD_2030" "EHYD_2040" "EHYD_2050"</span></span>
<span><span class="va">EHYD</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">EHYD_2020</span><span class="op">@</span><span class="va">weather</span></span>
<span><span class="co">#&gt;   weather comm wafc.lo wafc.up wafc.fx waf.lo waf.up waf.fx wafs.lo wafs.up</span></span>
<span><span class="co">#&gt; 1    WHYD &lt;NA&gt;      NA      NA      NA     NA     NA      1      NA      NA</span></span>
<span><span class="co">#&gt;   wafs.fx</span></span>
<span><span class="co">#&gt; 1      NA</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/draw.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">EHYD</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">EHYD_2020</span><span class="op">)</span></span></code></pre></div>
<p><img src="electricity_files/figure-html/unnamed-chunk-24-1.png" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="nuclear">Nuclear<a class="anchor" aria-label="anchor" href="#nuclear"></a>
</h3>
<p>Nuclear power plants are also quite controversial, and the decision
on their development is based on the long-term energy policy, the
availability of the uranium resources, the safety and environmental
concerns, and the public acceptance. Here we assume that the existing
capacity of nuclear power plants do not retire (until 2050) with further
linear fading out by 2080. The new investments are limited by a separate
constraint (see <em>Policies</em> section), which can be dropped or
relaxed in a particulate scenarios if decided.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cap_nuc</span> <span class="op">&lt;-</span> <span class="va">cap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Nuclear"</span>, <span class="va">primary_fuel</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">offshore</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume no retirement up to 2050</span></span>
<span><span class="va">cap_nuc_2050</span> <span class="op">&lt;-</span> <span class="va">cap_nuc</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2050</span>, capacity_mw <span class="op">=</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># linear retirement from 2050 capacity by 2080</span></span>
<span><span class="va">cap_nuc_LAST</span> <span class="op">&lt;-</span> <span class="va">cap_nuc</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2080</span>, capacity_mw <span class="op">=</span> <span class="fl">1e-20</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine</span></span>
<span><span class="va">cap_nuc</span> <span class="op">&lt;-</span> <span class="va">cap_nuc</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_nuc_2050</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_nuc_LAST</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load base-year technology</span></span>
<span><span class="va">ENUC_2020</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">ENUC</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">ENUC_2020</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ENUC_2020</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "technology"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "energyRt"</span></span>
<span></span>
<span><span class="co"># update base-year technology with preexisting capacity</span></span>
<span><span class="va">ENUC_2020</span> <span class="op">&lt;-</span> <span class="va">ENUC_2020</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>    capacity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      region <span class="op">=</span> <span class="va">cap_nuc</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      year <span class="op">=</span> <span class="va">cap_nuc</span><span class="op">$</span><span class="va">year</span>,</span>
<span>      stock <span class="op">=</span> <span class="va">cap_nuc</span><span class="op">$</span><span class="va">capacity_mw</span> <span class="op">/</span> <span class="fl">1e3</span> <span class="co"># in GW</span></span>
<span>    <span class="op">)</span>,</span>
<span>    end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>end <span class="op">=</span> <span class="fl">2010</span><span class="op">)</span> <span class="co"># not available for investment</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">ENUC</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">ENUC</span> <span class="op">|&gt;</span> <span class="co"># all nuclear techs</span></span>
<span>  <span class="fu">add</span><span class="op">(</span><span class="va">ENUC_2020</span>, overwrite <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># replace with the existing capacity</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ENUC</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ENUC_2020" "ENUC_2030" "ENUC_2040" "ENUC_2050"</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/draw.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">ENUC</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">ENUC_2020</span><span class="op">)</span></span></code></pre></div>
<p><img src="electricity_files/figure-html/unnamed-chunk-25-1.png" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="ccs">CCS<a class="anchor" aria-label="anchor" href="#ccs"></a>
</h3>
<p>Coal- and gas-fired power plants with carbon capture and storage
(CCS) technologies has been defined in “ccus” article and stored in the
<code>ideea_modules$CCUS</code> repository. There are two types of CCS
technologies: with fixed and flexible capture rates. The fixed capture
rate is assumed to be used any time the technology produces electricity,
while the flexible capture rate can be adjusted depending on the policy
and carbon market conditions. Here we add the flexible CCS
technologies.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add coal and gas CCS techs from `ideea_modules$CCUS`</span></span>
<span><span class="va">ccus_module</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">CCUS</span></span>
<span></span>
<span><span class="va">repo_ccstechs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"CCS Technologies"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Repository for CCS technologies"</span>,</span>
<span>  <span class="va">ccus_module</span><span class="op">$</span><span class="va">CCSCO2</span>, <span class="co"># commodity to represent captured CO2</span></span>
<span>  <span class="va">ccus_module</span><span class="op">$</span><span class="va">GHG</span>, <span class="co"># composite commodity--all GHGs</span></span>
<span>  </span>
<span>  <span class="co">## option 1: Fixed CCS technology (see CCUS description)</span></span>
<span>  <span class="co"># ccus_module$ECOA_CCS_FX, # Coal plant with CCS</span></span>
<span>  <span class="co"># ccus_module$EGAS_CCS_FX, # Natural gas plant with CCS</span></span>
<span>  </span>
<span>  <span class="co">## option 2: Variable CCS technology</span></span>
<span>  <span class="va">ccus_module</span><span class="op">$</span><span class="va">COA0</span>, <span class="co"># coal commodity with captured CO2</span></span>
<span>  <span class="va">ccus_module</span><span class="op">$</span><span class="va">ALIAS_COA</span>, <span class="co"># alias name COA == COA0 for supply</span></span>
<span>  <span class="va">ccus_module</span><span class="op">$</span><span class="va">ECOA_CCS_FL</span>, <span class="co"># Coal power plant with variable CCS tech</span></span>
<span>  <span class="va">ccus_module</span><span class="op">$</span><span class="va">GAS0</span>, <span class="co"># gas commodity with captured CO2</span></span>
<span>  <span class="va">ccus_module</span><span class="op">$</span><span class="va">ALIAS_GAS</span>, <span class="co"># alias name GAS0 == CAS for supply</span></span>
<span>  <span class="va">ccus_module</span><span class="op">$</span><span class="va">EGAS_CCS_FL</span> <span class="co"># gas power plant with variable CCS tech</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">ccus_module</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bio-energy">Bio energy<a class="anchor" aria-label="anchor" href="#bio-energy"></a>
</h3>
<p>The biomass-fired power plants are represented by the
<code>EBIO</code> technology with the existing capacity from the WRI
dataset. The new investments are available for the biomass technologies
with different vintages up to 2050. We don’t consider CCS for biomass
technologies in this example, but it can be added if needed.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cap_bio</span> <span class="op">&lt;-</span> <span class="va">cap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Biomass"</span>, <span class="va">primary_fuel</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">offshore</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume retirement of 2020 capacity by 2030</span></span>
<span><span class="va">cap_bio_2030</span> <span class="op">&lt;-</span> <span class="va">cap_bio</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2030</span>, capacity_mw <span class="op">=</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assume retirement of 2020 capacity by 2030</span></span>
<span><span class="va">cap_bio_2060</span> <span class="op">&lt;-</span> <span class="va">cap_bio</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2060</span>, capacity_mw <span class="op">=</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">capacity_mw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine</span></span>
<span><span class="va">cap_bio</span> <span class="op">&lt;-</span> <span class="va">cap_bio</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_bio_2030</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cap_bio_2060</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load base-year technology</span></span>
<span><span class="va">EBIO_2020</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">EBIO</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">EBIO_2020</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">EBIO_2020</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "technology"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "energyRt"</span></span>
<span></span>
<span><span class="co"># update base-year technology with preexisting capacity</span></span>
<span><span class="va">EBIO_2020</span> <span class="op">&lt;-</span> <span class="va">EBIO_2020</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/update.html" class="external-link">update</a></span><span class="op">(</span>capacity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    region <span class="op">=</span> <span class="va">cap_bio</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    year <span class="op">=</span> <span class="va">cap_bio</span><span class="op">$</span><span class="va">year</span>,</span>
<span>    stock <span class="op">=</span> <span class="va">cap_bio</span><span class="op">$</span><span class="va">capacity_mw</span> <span class="op">/</span> <span class="fl">1e3</span> <span class="co"># in GW</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">EBIO</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">EBIO</span> <span class="op">|&gt;</span> <span class="co">#</span></span>
<span>  <span class="fu">add</span><span class="op">(</span><span class="va">EBIO_2020</span>, overwrite <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># add tech with existing capacity</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EBIO</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "EBIO_2020" "EBIO_2030" "EBIO_2040" "EBIO_2050"</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/draw.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">EBIO</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">EBIO_2020</span><span class="op">)</span></span></code></pre></div>
<p><img src="electricity_files/figure-html/unnamed-chunk-27-1.png" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="energy-storage">Energy storage<a class="anchor" aria-label="anchor" href="#energy-storage"></a>
</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ideea_modules$techs</span></span>
<span><span class="va">STG_BTR</span> <span class="op">&lt;-</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">techs</span><span class="op">$</span><span class="va">STG_BTR</span></span>
<span><span class="va">STG_BTR</span><span class="op">$</span><span class="va">STG_BTR_2020</span><span class="op">@</span><span class="va">fullYear</span> <span class="co"># storage cycle over year or withing YDAY</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># create daily storage (optional)</span></span>
<span><span class="va">STG_BTR_daily</span> <span class="op">&lt;-</span> <span class="va">STG_BTR</span></span>
<span><span class="va">STG_BTR_daily</span><span class="op">@</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">STG_BTR_daily</span><span class="op">@</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">ob</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/slot.html" class="external-link">.hasSlot</a></span><span class="op">(</span><span class="va">ob</span>, <span class="st">"fullYear"</span><span class="op">)</span><span class="op">)</span> <span class="va">ob</span><span class="op">@</span><span class="va">fullYear</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>  <span class="va">ob</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">STG_BTR_daily</span><span class="op">$</span><span class="va">STG_BTR_2020</span><span class="op">@</span><span class="va">fullYear</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="transmission">Transmission<a class="anchor" aria-label="anchor" href="#transmission"></a>
</h2>
<div class="section level3">
<h3 id="hvac">HVAC<a class="anchor" aria-label="anchor" href="#hvac"></a>
</h3>
<p>HVAC cost: INR 1.56 Cr/km/GW Losses: 7%-10% per 1000km HVDC Cost: INR
3-5 Cr/km Losses: 1-3% per 1000km</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">network</span> <span class="op">&lt;-</span> <span class="va">ideea_data</span><span class="op">$</span><span class="va">transmission</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">case</span> <span class="op">==</span> <span class="va">transmission_matrix</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">MW</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># rename(dst = region1) |&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">MW</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">repo_transmission_ac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span><span class="st">"transmission"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">trd</span> <span class="op">&lt;-</span> <span class="fu">newTrade</span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="va">network</span><span class="op">$</span><span class="va">trd_name_ac</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>      desc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Bi-directional HVAC transmission line between "</span>,</span>
<span>                    <span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">" and "</span>,</span>
<span>                    <span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">lines_type</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, <span class="st">""</span>, </span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">" ("</span>, <span class="va">network</span><span class="op">$</span><span class="va">lines_type</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span>                    <span class="op">)</span>,</span>
<span>      commodity <span class="op">=</span> <span class="st">"ELC"</span>,</span>
<span>      routes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        src <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        dst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      trade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        src <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        dst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        teff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">AC_eff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">AC_eff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      capacityVariable <span class="op">=</span> <span class="cn">T</span>,</span>
<span>      invcost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        <span class="co"># convert(1000, "USD/MW/mi", "cr.INR/GW/km") ~= 5 cr.INR/GW/km</span></span>
<span>        <span class="co"># see: https://www.nrel.gov/docs/fy22osti/81662.pdf</span></span>
<span>        region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        invcost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">AC_invcost</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># olife == 2</span></span>
<span>      <span class="op">)</span>,</span>
<span>      olife <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>olife <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>, <span class="co"># doubled annualized invcost for consistency</span></span>
<span>      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">base_year</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>      capacity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">2030</span>, <span class="fl">2050</span>, <span class="fl">2070</span><span class="op">)</span>,</span>
<span>        stock <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>          <span class="va">network</span><span class="op">$</span><span class="va">MW</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span>, <span class="va">network</span><span class="op">$</span><span class="va">MW</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span>,</span>
<span>          <span class="va">network</span><span class="op">$</span><span class="va">MW</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span>, <span class="va">network</span><span class="op">$</span><span class="va">MW</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="co"># ncap.up = 5, # upper limit on new transmission by year</span></span>
<span>        cap.up <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">network</span><span class="op">$</span><span class="va">MW</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span> <span class="op">+</span> <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># upper limit on transmission capacity</span></span>
<span>      <span class="op">)</span>,</span>
<span>      cap2act <span class="op">=</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">365</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">repo_transmission_ac</span> <span class="op">&lt;-</span> <span class="fu">add</span><span class="op">(</span><span class="va">repo_transmission_ac</span>, <span class="va">trd</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">trd</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">repo_transmission_ac</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "HVAC_NORTH_WEST"      "HVAC_NORTH_EAST"      "HVAC_NORTH_NORTHEAST"</span></span>
<span><span class="co">#&gt;  [4] "HVAC_WEST_NORTH"      "HVAC_WEST_SOUTH"      "HVAC_WEST_EAST"      </span></span>
<span><span class="co">#&gt;  [7] "HVAC_SOUTH_WEST"      "HVAC_SOUTH_EAST"      "HVAC_EAST_NORTH"     </span></span>
<span><span class="co">#&gt; [10] "HVAC_EAST_WEST"       "HVAC_EAST_SOUTH"      "HVAC_EAST_NORTHEAST" </span></span>
<span><span class="co">#&gt; [13] "HVAC_NORTHEAST_NORTH" "HVAC_NORTHEAST_EAST"</span></span>
<span><span class="va">repo_transmission_ac</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; An object of class "trade"</span></span>
<span><span class="co">#&gt; Slot "name":</span></span>
<span><span class="co">#&gt; [1] "HVAC_NORTH_WEST"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "desc":</span></span>
<span><span class="co">#&gt; [1] "Bi-directional HVAC transmission line between NORTH and WEST"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "commodity":</span></span>
<span><span class="co">#&gt; [1] "ELC"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "routes":</span></span>
<span><span class="co">#&gt;     src   dst</span></span>
<span><span class="co">#&gt; 1 NORTH  WEST</span></span>
<span><span class="co">#&gt; 2  WEST NORTH</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "trade":</span></span>
<span><span class="co">#&gt;     src   dst year slice ava.up ava.fx ava.lo      teff</span></span>
<span><span class="co">#&gt; 1 NORTH  WEST   NA  &lt;NA&gt;     NA     NA     NA 0.9118264</span></span>
<span><span class="co">#&gt; 2  WEST NORTH   NA  &lt;NA&gt;     NA     NA     NA 0.9118264</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "aux":</span></span>
<span><span class="co">#&gt; [1] acomm unit </span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "aeff":</span></span>
<span><span class="co">#&gt; [1] acomm     src       dst       year      slice     csrc2aout csrc2ainp</span></span>
<span><span class="co">#&gt; [8] cdst2aout cdst2ainp</span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "invcost":</span></span>
<span><span class="co">#&gt;   region year invcost wacc retcost</span></span>
<span><span class="co">#&gt; 1  NORTH   NA     967   NA      NA</span></span>
<span><span class="co">#&gt; 2   WEST   NA     967   NA      NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "fixom":</span></span>
<span><span class="co">#&gt; [1] region year   fixom </span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "varom":</span></span>
<span><span class="co">#&gt; [1] src    dst    year   varom  markup</span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "olife":</span></span>
<span><span class="co">#&gt;   year olife</span></span>
<span><span class="co">#&gt; 1   NA    60</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "start":</span></span>
<span><span class="co">#&gt;   start</span></span>
<span><span class="co">#&gt; 1  2009</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "end":</span></span>
<span><span class="co">#&gt;   end</span></span>
<span><span class="co">#&gt; 1 Inf</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "capacity":</span></span>
<span><span class="co">#&gt;   year stock cap.lo cap.up cap.fx ncap.lo ncap.up ncap.fx ret.lo ret.up ret.fx</span></span>
<span><span class="co">#&gt; 1 2020 15.42     NA  40.84     NA      NA      NA      NA     NA     NA     NA</span></span>
<span><span class="co">#&gt; 2 2030 15.42     NA  40.84     NA      NA      NA      NA     NA     NA     NA</span></span>
<span><span class="co">#&gt; 3 2050 15.42     NA  40.84     NA      NA      NA      NA     NA     NA     NA</span></span>
<span><span class="co">#&gt; 4 2070 15.42     NA  40.84     NA      NA      NA      NA     NA     NA     NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "capacityVariable":</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "cap2act":</span></span>
<span><span class="co">#&gt; [1] 8760</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "optimizeRetirement":</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "misc":</span></span>
<span><span class="co">#&gt; list()</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hvdc">HVDC<a class="anchor" aria-label="anchor" href="#hvdc"></a>
</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">EDC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/commodity.html" class="external-link">newCommodity</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"EDC"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Ultra high voltage DC electricity"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"GWh"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Converters (inverter and rectifier stations)</span></span>
<span><span class="va">EDC2ELC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/technology.html" class="external-link">newTechnology</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"EDC2ELC"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Inverter station"</span>,</span>
<span>  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comm <span class="op">=</span> <span class="st">"EDC"</span>, unit <span class="op">=</span> <span class="st">"GWh"</span><span class="op">)</span>,</span>
<span>  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comm <span class="op">=</span> <span class="st">"ELC"</span>, unit <span class="op">=</span> <span class="st">"GWh"</span><span class="op">)</span>,</span>
<span>  invcost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    invcost <span class="op">=</span> <span class="fl">500</span></span>
<span>  <span class="op">)</span>, </span>
<span>  ceff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    comm <span class="op">=</span> <span class="st">"ELC"</span>,</span>
<span>    cact2cout <span class="op">=</span> <span class="fl">.99</span></span>
<span>    <span class="op">)</span>,</span>
<span>  olife <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>olife <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>  cap2act <span class="op">=</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/draw.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">EDC2ELC</span><span class="op">)</span></span></code></pre></div>
<p><img src="electricity_files/figure-html/unnamed-chunk-30-1.png" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ELC2EDC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/technology.html" class="external-link">newTechnology</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"ELC2EDC"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Rectifier station"</span>,</span>
<span>  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comm <span class="op">=</span> <span class="st">"EDC"</span>, unit <span class="op">=</span> <span class="st">"GWh"</span><span class="op">)</span>,</span>
<span>  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comm <span class="op">=</span> <span class="st">"ELC"</span>, unit <span class="op">=</span> <span class="st">"GWh"</span><span class="op">)</span>,</span>
<span>  invcost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    invcost <span class="op">=</span> <span class="fl">500</span></span>
<span>  <span class="op">)</span>, </span>
<span>  ceff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    comm <span class="op">=</span> <span class="st">"EDC"</span>,</span>
<span>    cact2cout <span class="op">=</span> <span class="fl">.99</span><span class="op">)</span>,</span>
<span>  olife <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>olife <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>  cap2act <span class="op">=</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/draw.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">ELC2EDC</span><span class="op">)</span></span></code></pre></div>
<p><img src="electricity_files/figure-html/unnamed-chunk-30-2.png" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">repo_transmission_dc</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"transmission_dc"</span>, <span class="va">EDC</span>, <span class="va">EDC2ELC</span>, <span class="va">ELC2EDC</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">trd</span> <span class="op">&lt;-</span> <span class="fu">newTrade</span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="va">network</span><span class="op">$</span><span class="va">trd_name_dc</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>      desc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Bi-directional HVDC transmission line between "</span>,</span>
<span>                    <span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">" and "</span>,</span>
<span>                    <span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">lines_type</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, <span class="st">""</span>, </span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">" ("</span>, <span class="va">network</span><span class="op">$</span><span class="va">lines_type</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span>                    <span class="op">)</span>,</span>
<span>      commodity <span class="op">=</span> <span class="st">"EDC"</span>,</span>
<span>      routes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        src <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        dst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      trade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        src <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        dst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        teff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">DC_eff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">DC_eff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      capacityVariable <span class="op">=</span> <span class="cn">T</span>,</span>
<span>      invcost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        <span class="co"># convert(1000, "USD/MW/mi", "cr.INR/GW/km") ~= 5 cr.INR/GW/km</span></span>
<span>        <span class="co"># see: https://www.nrel.gov/docs/fy22osti/81662.pdf</span></span>
<span>        region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">region.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">network</span><span class="op">$</span><span class="va">region.y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        invcost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">DC_invcost</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># olife == 2</span></span>
<span>      <span class="op">)</span>,</span>
<span>      olife <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>olife <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>, <span class="co"># doubled annualized invcost for consistency</span></span>
<span>      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">base_year</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>      capacity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">2030</span>, <span class="fl">2050</span>, <span class="fl">2070</span><span class="op">)</span>,</span>
<span>        stock <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>          <span class="va">network</span><span class="op">$</span><span class="va">MW</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span>, <span class="va">network</span><span class="op">$</span><span class="va">MW</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span>,</span>
<span>          <span class="va">network</span><span class="op">$</span><span class="va">MW</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span>, <span class="va">network</span><span class="op">$</span><span class="va">MW</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span></span>
<span>        <span class="op">)</span>,</span>
<span>        cap.up <span class="op">=</span> <span class="fl">100</span> <span class="co"># upper limit on transmission capacity</span></span>
<span>      <span class="op">)</span>,</span>
<span>      cap2act <span class="op">=</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">365</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">repo_transmission_dc</span> <span class="op">&lt;-</span> <span class="fu">add</span><span class="op">(</span><span class="va">repo_transmission_dc</span>, <span class="va">trd</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">trd</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">repo_transmission_dc</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "EDC"                  "EDC2ELC"              "ELC2EDC"             </span></span>
<span><span class="co">#&gt;  [4] "HVDC_NORTH_WEST"      "HVDC_NORTH_EAST"      "HVDC_NORTH_NORTHEAST"</span></span>
<span><span class="co">#&gt;  [7] "HVDC_WEST_NORTH"      "HVDC_WEST_SOUTH"      "HVDC_WEST_EAST"      </span></span>
<span><span class="co">#&gt; [10] "HVDC_SOUTH_WEST"      "HVDC_SOUTH_EAST"      "HVDC_EAST_NORTH"     </span></span>
<span><span class="co">#&gt; [13] "HVDC_EAST_WEST"       "HVDC_EAST_SOUTH"      "HVDC_EAST_NORTHEAST" </span></span>
<span><span class="co">#&gt; [16] "HVDC_NORTHEAST_NORTH" "HVDC_NORTHEAST_EAST"</span></span>
<span><span class="co"># (optional) filter out some lines in mountainous regions</span></span>
<span><span class="va">repo_transmission_dc</span><span class="op">@</span><span class="va">data</span><span class="op">[[</span><span class="st">"HVDC_HP_JK"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">repo_transmission_dc</span><span class="op">@</span><span class="va">data</span><span class="op">[[</span><span class="st">"HVDC_SK_WB"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">repo_transmission_dc</span><span class="op">@</span><span class="va">data</span><span class="op">[[</span><span class="st">"HVDC_BR_SK"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">repo_transmission_dc</span><span class="op">@</span><span class="va">data</span><span class="op">[[</span><span class="st">"HVDC_ML_SK"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="unserved-load">Unserved load<a class="anchor" aria-label="anchor" href="#unserved-load"></a>
</h2>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UNSERVED</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newImport.html" class="external-link">newImport</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"UNSERVED"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Unserved load, ~ 10 cr.INR/GWh, equal 100 INR/kWh"</span>,</span>
<span>  commodity <span class="op">=</span> <span class="st">"ELC"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"GWh"</span>,</span>
<span>  imp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>price <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="policies">Policies<a class="anchor" aria-label="anchor" href="#policies"></a>
</h2>
<p>carbon emissions, climate, air quality, SOx, NOx, PM, etc.<br>
* national<br>
* state, local<br>
any other regulations of electric power sector</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CO2_CAP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newConstraint.html" class="external-link">newConstraint</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"CO2_CAP"</span>,</span>
<span>  eq <span class="op">=</span> <span class="st">"&lt;="</span>,</span>
<span>  rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">2060</span>, <span class="fl">2100</span><span class="op">)</span>,</span>
<span>    rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">900000</span>, <span class="fl">1e-10</span>, <span class="fl">1e-10</span><span class="op">)</span> <span class="co"># CO2 cap assumptions</span></span>
<span>  <span class="op">)</span>,</span>
<span>  for.each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2025</span><span class="op">:</span><span class="fl">2100</span><span class="op">)</span>, <span class="co"># Cap total emission</span></span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="st">"vBalance"</span>,</span>
<span>    for.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      comm <span class="op">=</span> <span class="st">"CO2"</span>,</span>
<span>      slice <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>      region <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  defVal <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  interpolation <span class="op">=</span> <span class="st">"inter.forth"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">CO2_CAP</span><span class="op">@</span><span class="va">rhs</span></span>
<span><span class="co">#&gt;   year   rhs</span></span>
<span><span class="co">#&gt; 1 2025 9e+05</span></span>
<span><span class="co">#&gt; 2 2060 1e-10</span></span>
<span><span class="co">#&gt; 3 2100 1e-10</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NO_NEW_HYDRO</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newConstraint.html" class="external-link">newConstraint</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"NO_NEW_HYDRO"</span>,</span>
<span>  <span class="co"># desc = "Constraint on new Hydro plants construction",</span></span>
<span>  eq <span class="op">=</span> <span class="st">"&lt;="</span>,</span>
<span>  for.each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="st">"vTechNewCap"</span>,</span>
<span>    for.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      tech <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EHYD_2030"</span>, <span class="st">"EHYD_2040"</span>, <span class="st">"EHYD_2050"</span>, <span class="st">"EHYD_2020"</span><span class="op">)</span>,</span>
<span>      region <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">2060</span><span class="op">)</span>,</span>
<span>    rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-20</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  defVal <span class="op">=</span> <span class="fl">1e-20</span>,</span>
<span>  interpolation <span class="op">=</span> <span class="st">"inter.forth"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">NO_NEW_NUCLEAR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newConstraint.html" class="external-link">newConstraint</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"NO_NEW_NUCLEAR"</span>,</span>
<span>  <span class="co"># desc = "Constraint on new Hydro plants construction",</span></span>
<span>  eq <span class="op">=</span> <span class="st">"&lt;="</span>,</span>
<span>  for.each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span><span class="op">:</span><span class="fl">2060</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="st">"vTechNewCap"</span>,</span>
<span>    for.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      tech <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ENUC_2030"</span>, <span class="st">"ENUC_2040"</span>, <span class="st">"ENUC_2050"</span>, <span class="st">"ENUC_2020"</span><span class="op">)</span>,</span>
<span>      region <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">:</span><span class="fl">2060</span><span class="op">)</span>,</span>
<span>    rhs <span class="op">=</span> <span class="fl">1e-20</span></span>
<span>    <span class="co"># rhs = c(1e-7) #eps</span></span>
<span>  <span class="op">)</span>,</span>
<span>  defVal <span class="op">=</span> <span class="fl">1e-20</span>,</span>
<span>  interpolation <span class="op">=</span> <span class="st">"inter.forth"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># dput(names(ESOL))</span></span>
<span><span class="va">NO_NEW_SOLAR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newConstraint.html" class="external-link">newConstraint</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"NO_NEW_SOLAR"</span>,</span>
<span>  <span class="co"># desc = "Constraint on new Hydro plants construction",</span></span>
<span>  eq <span class="op">=</span> <span class="st">"&lt;="</span>,</span>
<span>  for.each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span><span class="op">:</span><span class="fl">2060</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="st">"vTechNewCap"</span>,</span>
<span>    for.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      tech <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ESOL</span><span class="op">)</span>,</span>
<span>      region <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">:</span><span class="fl">2060</span><span class="op">)</span>,</span>
<span>    rhs <span class="op">=</span> <span class="fl">1e-20</span></span>
<span>    <span class="co"># rhs = c(1e-7) #eps</span></span>
<span>  <span class="op">)</span>,</span>
<span>  defVal <span class="op">=</span> <span class="fl">1e-20</span>,</span>
<span>  interpolation <span class="op">=</span> <span class="st">"inter.forth"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">NO_NEW_WIND</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newConstraint.html" class="external-link">newConstraint</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"NO_NEW_WIND"</span>,</span>
<span>  <span class="co"># desc = "Constraint on new Hydro plants construction",</span></span>
<span>  eq <span class="op">=</span> <span class="st">"&lt;="</span>,</span>
<span>  for.each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span><span class="op">:</span><span class="fl">2060</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="st">"vTechNewCap"</span>,</span>
<span>    for.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      tech <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EWIN</span><span class="op">)</span>,</span>
<span>      region <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">:</span><span class="fl">2060</span><span class="op">)</span>,</span>
<span>    rhs <span class="op">=</span> <span class="fl">1e-20</span></span>
<span>  <span class="op">)</span>,</span>
<span>  defVal <span class="op">=</span> <span class="fl">1e-20</span>,</span>
<span>  interpolation <span class="op">=</span> <span class="st">"inter.forth"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># dput(names(EGAS))</span></span>
<span><span class="va">CT_EGAS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newConstraint.html" class="external-link">newConstraint</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"CT_EGAS"</span>,</span>
<span>  <span class="co"># desc = "Constraint on new Hydro plants construction",</span></span>
<span>  eq <span class="op">=</span> <span class="st">"&lt;="</span>,</span>
<span>  for.each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">2055</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="st">"vTechNewCap"</span>,</span>
<span>    for.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      tech <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EGAS</span><span class="op">)</span>,</span>
<span>      region <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">2055</span><span class="op">)</span>,</span>
<span>    rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  defVal <span class="op">=</span> <span class="fl">1e-20</span>,</span>
<span>  interpolation <span class="op">=</span> <span class="st">"inter.forth"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># limit on hydro construction</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># No Base year investment</span></span>
<span><span class="va">NO_BY_INV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newConstraint.html" class="external-link">newConstraint</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"NO_BY_INV"</span>,</span>
<span>  eq <span class="op">=</span> <span class="st">"&lt;="</span>,</span>
<span>  for.each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">2021</span>, <span class="fl">2060</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="st">"vTechNewCap"</span>,</span>
<span>    for.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      tech <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      region <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">2021</span>, <span class="fl">2060</span><span class="op">)</span>,</span>
<span>    rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-20</span>, <span class="fl">1e10</span>, <span class="fl">1e10</span><span class="op">)</span> <span class="co">#</span></span>
<span>  <span class="op">)</span>,</span>
<span>  defVal <span class="op">=</span> <span class="fl">1e10</span>, <span class="co"># large number (Inf may not work as expected in some solvers)</span></span>
<span>  interpolation <span class="op">=</span> <span class="st">"inter.forth"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>An optional, additional constraint on Solar Capacity Deployment
across regions. By default, the constraint on capacity is set for every
cluster of regions based on available (estimated) land area and solar
radiation. However, the constraint can be adjusted for each region
separately as defined below for 5-region model case.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CT_ESOL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newConstraint.html" class="external-link">newConstraint</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"CT_ESOL"</span>,</span>
<span>  <span class="co"># desc = "Constraint on new solar plants construction",</span></span>
<span>  eq <span class="op">=</span> <span class="st">"&lt;="</span>,</span>
<span>  for.each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EAST"</span>, <span class="st">"NORTH"</span>, <span class="st">"NORTHEAST"</span>, <span class="st">"SOUTH"</span>, <span class="st">"WEST"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="st">"vTechCap"</span>,</span>
<span>    for.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      tech <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dput.html" class="external-link">dput</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ESOL</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      years <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>    region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NORTH"</span>, <span class="st">"SOUTH"</span>, <span class="st">"EAST"</span>, <span class="st">"WEST"</span>, <span class="st">"NORTHEAST"</span><span class="op">)</span>,</span>
<span>    rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">336.250</span>, <span class="fl">107.330</span>, <span class="fl">66.360</span>, <span class="fl">180.9</span>, <span class="fl">57.36</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  defVal <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  interpolation <span class="op">=</span> <span class="st">"back.inter.forth"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h2>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">repo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newRepository.html" class="external-link">newRepository</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"repo_electricity_{regN}"</span><span class="op">)</span>,</span>
<span>  <span class="co"># commodities</span></span>
<span>  <span class="va">repo_comm</span>,</span>
<span>  <span class="co"># supply &amp; import</span></span>
<span>  <span class="va">repo_supply</span>,</span>
<span>  <span class="co"># Generating technologies</span></span>
<span>  <span class="va">ECOA</span>,</span>
<span>  <span class="va">EGAS</span>, <span class="va">CT_EGAS</span>, <span class="co"># gas-fired generators with limit on construction</span></span>
<span>  <span class="va">ENUC</span>,</span>
<span>  <span class="va">NO_NEW_NUCLEAR</span>, <span class="co"># limit on nuclear construction</span></span>
<span>  <span class="va">EHYD</span>, <span class="va">WHYD</span>,</span>
<span>  <span class="va">NO_NEW_HYDRO</span>, <span class="co"># limit on hydro construction</span></span>
<span>  <span class="va">ESOL</span>, <span class="va">WSOL</span>, <span class="co"># solar PVs</span></span>
<span>  <span class="va">EWIN</span>, <span class="va">WWIN</span>, <span class="co"># onshore wind</span></span>
<span>  <span class="va">EWIF</span>, <span class="va">WWIF</span>, <span class="co"># offshore wind</span></span>
<span>  <span class="va">EBIO</span>, </span>
<span>  <span class="co"># battery</span></span>
<span>  <span class="va">STG_BTR</span>, <span class="co"># storage with annual cycle</span></span>
<span>  <span class="co"># STG_BTR_daily, # alternative storage with daily cycle</span></span>
<span>  <span class="co"># transmission</span></span>
<span>  <span class="va">repo_transmission_ac</span>,</span>
<span>  <span class="va">repo_transmission_dc</span>,</span>
<span>  <span class="va">repo_geoccs</span>,</span>
<span>  <span class="va">repo_ccstechs</span>,</span>
<span>  <span class="co"># unserved load</span></span>
<span>  <span class="va">UNSERVED</span>, <span class="co"># unserved load penalty</span></span>
<span>  <span class="co"># demand</span></span>
<span>  <span class="va">DEMELC_BY</span>, <span class="co"># BY demand</span></span>
<span>  <span class="va">DEMELC_2X</span>, <span class="co"># additional demand</span></span>
<span>  <span class="co"># CT_ESOL, # solar capacity constraints</span></span>
<span>  <span class="va">NO_BY_INV</span> <span class="co">#</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print(repo)</span></span>
<span><span class="co"># names(repo)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">repo</span><span class="op">)</span></span>
<span><span class="co">#&gt;  commodity constraint     demand     import    storage     supply technology </span></span>
<span><span class="co">#&gt;         17         59          2          5          4          6        251 </span></span>
<span><span class="co">#&gt;      trade    weather </span></span>
<span><span class="co">#&gt;         28         56</span></span>
<span></span>
<span><span class="co"># model horizon</span></span>
<span><span class="co"># horizon_2020_2060_by_10 &lt;- newHorizon(</span></span>
<span><span class="co">#   period = 2020:2060,</span></span>
<span><span class="co">#   intervals = c(1, 5, rep(10, 15)),</span></span>
<span><span class="co">#   mid_is_end = T</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># horizon_2020_2060_by_10</span></span>
<span></span>
<span><span class="co"># model-class object</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/newModel.html" class="external-link">newModel</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"IDEEA_ELC_{regN}"</span><span class="op">)</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"IDEEA electricity example model"</span>,</span>
<span>  region <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ideea_sf</span><span class="op">[[</span><span class="va">regN</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  discount <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  calendar <span class="op">=</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">calendars</span><span class="op">$</span><span class="va">calendar_d365_h24_full</span>,</span>
<span>  horizon <span class="op">=</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">calendars</span><span class="op">$</span><span class="va">horizon_2020_2060_by_10</span>,</span>
<span>  data <span class="op">=</span> <span class="va">repo</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># mod@config@horizon@intervals</span></span>
<span><span class="co"># mod@config@calendar@timetable</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="solving-the-model">Solving the model<a class="anchor" aria-label="anchor" href="#solving-the-model"></a>
</h2>
<p>Note: The full model requires powerful solver (CPLEX or GUROBI) and
GAMS Julia or Python + CPLEX/GUROBI will also work, but currently
require more time to generate the problem for the solver.<br>
It is recommended to solve the model for a portion of a year (subset of
time-slices), which can be solved with free solvers such as HiGHS or
Cbc.</p>
<div class="section level3">
<h3 id="reference-scenario---subset">Reference scenario - subset<a class="anchor" aria-label="anchor" href="#reference-scenario---subset"></a>
</h3>
<p>Quick way to have a glimpse of the results</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set_progress_bar("progress")</span></span>
<span><span class="co"># Reference case</span></span>
<span><span class="va">scen_REF_sub</span> <span class="op">&lt;-</span> <span class="fu">interpolate_model</span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"REF_sub"</span>, <span class="co"># indicating 'subset'</span></span>
<span>  calendar <span class="op">=</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">calendars</span><span class="op">$</span><span class="va">calendar_d365_h24_subset_1day_per_month</span>,</span>
<span>  horizon <span class="op">=</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">calendars</span><span class="op">$</span><span class="va">horizon_2020_2060_by_10</span></span>
<span>  <span class="co"># path = file.path("scenarios", glue("REF_sub_r{nreg}")),</span></span>
<span>  <span class="co"># STG_BTR_daily, # Battery, modeled with daily cycle for sampled calendar</span></span>
<span>  <span class="co"># partial_calendar, # add partial calendar to the interpolate function</span></span>
<span>  <span class="co"># ideea_modules$calendars$horizon_2050</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">scen_REF_sub</span><span class="op">@</span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/ideea_scenarios.html">ideea_scenarios</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/ideea_scenario_dir_name.html">ideea_scenario_dir_name</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"REF_sub"</span>, </span>
<span>    model_name <span class="op">=</span> <span class="va">scen_REF_sub</span><span class="op">@</span><span class="va">model</span><span class="op">@</span><span class="va">name</span>, </span>
<span>    calendar_name <span class="op">=</span> <span class="va">scen_REF_sub</span><span class="op">@</span><span class="va">settings</span><span class="op">@</span><span class="va">calendar</span><span class="op">@</span><span class="va">name</span>, </span>
<span>    horizon_name <span class="op">=</span> <span class="st">"2020_2060_by_10"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">scen_REF_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/write.html" class="external-link">write_sc</a></span><span class="op">(</span></span>
<span>  <span class="va">scen_REF_sub</span>,</span>
<span>  solver <span class="op">=</span> <span class="va">solver_options</span><span class="op">$</span><span class="va">gams_gdx_cplex_barrier</span></span>
<span>  <span class="co"># solver = solver_options$gams_gdx_cplex_parallel</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_barrier</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_simplex</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_parallel</span></span>
<span><span class="op">)</span></span>
<span><span class="va">scen_REF_sub</span><span class="op">@</span><span class="va">status</span></span>
<span><span class="va">scen_REF_sub</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">tmp.dir</span></span>
<span></span>
<span><span class="co"># solve_scenario(scen_REF_sub, wait = F, force = F)</span></span>
<span><span class="va">scen_REF_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">scen_REF_sub</span>, wait <span class="op">=</span> <span class="cn">F</span>, tmp.del <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">scen_REF_sub</span> <span class="op">&lt;-</span> <span class="fu">read</span><span class="op">(</span><span class="va">scen_REF_sub</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># store scenario on disk (unload from RAM)</span></span>
<span><span class="va">scen_REF_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/save_scenario.html" class="external-link">save_scenario</a></span><span class="op">(</span><span class="va">scen_REF_sub</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scen_REF_sub</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="policy-scenarios">Policy scenarios<a class="anchor" aria-label="anchor" href="#policy-scenarios"></a>
</h3>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CO2 cap</span></span>
<span><span class="va">scen_CAP_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/interpolate.html" class="external-link">interpolate</a></span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"CAP_sub"</span>, <span class="co"># indicating 'subset'</span></span>
<span>  <span class="co"># path = file.path("scenarios", glue("CAP_sub_r{nreg}_debug")),</span></span>
<span>  <span class="co"># here we can add policy objects</span></span>
<span>  <span class="co"># STG_BTR_daily, # Battery, modeled with daily cycle for sampled calendar</span></span>
<span>  <span class="va">CO2_CAP</span>,</span>
<span>  calendar <span class="op">=</span> <span class="va">ideea_modules</span><span class="op">$</span><span class="va">calendars</span><span class="op">$</span><span class="va">calendar_d365_h24_subset_1day_per_month</span>,</span>
<span>  <span class="co"># horizon = ideea_modules$calendars$horizon_2020_2060_by_10</span></span>
<span>  <span class="va">ideea_modules</span><span class="op">$</span><span class="va">calendars</span><span class="op">$</span><span class="va">horizon_2050</span></span>
<span>  <span class="co"># partial_calendar # add partial calendar to the interpolate function</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">scen_CAP_sub</span><span class="op">@</span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/ideea_scenarios.html">ideea_scenarios</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/ideea_scenario_dir_name.html">ideea_scenario_dir_name</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"CAP_sub"</span>, </span>
<span>    model_name <span class="op">=</span> <span class="va">mod</span><span class="op">@</span><span class="va">name</span>, </span>
<span>    calendar_name <span class="op">=</span> <span class="st">"d365_h24"</span>, </span>
<span>    horizon_name <span class="op">=</span> <span class="st">"2050"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scen_CAP_sub</span><span class="op">@</span><span class="va">path</span></span>
<span></span>
<span><span class="va">scen_CAP_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/write.html" class="external-link">write_sc</a></span><span class="op">(</span></span>
<span>  <span class="va">scen_CAP_sub</span>,</span>
<span>  solver <span class="op">=</span> <span class="va">solver_options</span><span class="op">$</span><span class="va">gams_gdx_cplex_barrier</span></span>
<span>  <span class="co"># solver = solver_options$gams_gdx_cplex_parallel</span></span>
<span>  <span class="co"># solver = solver_options$pyomo_glpk</span></span>
<span>  <span class="co"># solver = solver_options$pyomo_cbc</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_barrier</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_simplex</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_parallel</span></span>
<span><span class="op">)</span></span>
<span><span class="va">scen_CAP_sub</span></span>
<span><span class="va">scen_CAP_sub</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">tmp.dir</span></span>
<span></span>
<span><span class="fu"><a href="https://energyRt.org/reference/solve.html" class="external-link">solve_scenario</a></span><span class="op">(</span><span class="va">scen_CAP_sub</span>, wait <span class="op">=</span> <span class="cn">F</span>, force <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co"># scen_CAP_sub &lt;- solve(scen_CAP_sub, wait = T, tmp.del = F)</span></span>
<span><span class="va">scen_CAP_sub</span> <span class="op">&lt;-</span> <span class="fu">read</span><span class="op">(</span><span class="va">scen_CAP_sub</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># store scenario on disk (unload from RAM)</span></span>
<span><span class="va">scen_CAP_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/save_scenario.html" class="external-link">save_scenario</a></span><span class="op">(</span><span class="va">scen_CAP_sub</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scen_CAP_sub</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scen_REF</span> <span class="op">&lt;-</span> <span class="fu">interpolate_model</span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"REF"</span>, <span class="co"># indicating 'subset'</span></span>
<span>  <span class="co"># path = file.path("scenarios", glue("REF_r{nreg}")),</span></span>
<span>  <span class="co"># STG_BTR_daily, # Battery, modeled with daily cycle for sampled calendar</span></span>
<span>  <span class="co"># partial_calendar, # add partial calendar to the interpolate function</span></span>
<span>  <span class="va">ideea_modules</span><span class="op">$</span><span class="va">calendars</span><span class="op">$</span><span class="va">horizon_2060</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">scen_REF</span><span class="op">@</span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/ideea_scenarios.html">ideea_scenarios</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/ideea_scenario_dir_name.html">ideea_scenario_dir_name</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"REF"</span>, </span>
<span>    model_name <span class="op">=</span> <span class="va">mod</span><span class="op">@</span><span class="va">name</span>, </span>
<span>    calendar_name <span class="op">=</span> <span class="st">"d365_h24"</span>, </span>
<span>    horizon_name <span class="op">=</span> <span class="st">"2060"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scen_REF</span></span>
<span></span>
<span><span class="va">scen_REF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/write.html" class="external-link">write_sc</a></span><span class="op">(</span></span>
<span>  <span class="va">scen_REF</span>,</span>
<span>  solver <span class="op">=</span> <span class="va">solver_options</span><span class="op">$</span><span class="va">gams_gdx_cplex_barrier</span></span>
<span>  <span class="co"># solver = solver_options$gams_gdx_cplex_parallel</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_barrier</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_simplex</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_parallel</span></span>
<span><span class="op">)</span></span>
<span><span class="va">scen_REF</span><span class="op">@</span><span class="va">status</span></span>
<span><span class="va">scen_REF</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">tmp.dir</span></span>
<span></span>
<span><span class="co"># solve_scenario(scen_REF, wait = F, force = F)</span></span>
<span><span class="va">scen_REF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">scen_REF</span>, wait <span class="op">=</span> <span class="cn">F</span>, tmp.del <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">scen_REF</span> <span class="op">&lt;-</span> <span class="fu">read</span><span class="op">(</span><span class="va">scen_REF</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># store scenario on disk (unload from RAM)</span></span>
<span><span class="va">scen_REF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/save_scenario.html" class="external-link">save_scenario</a></span><span class="op">(</span><span class="va">scen_REF</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scen_REF</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://energyRt.org/reference/progress.html" class="external-link">set_progress_bar</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># CO2 cap</span></span>
<span><span class="va">scen_CAP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/interpolate.html" class="external-link">interpolate</a></span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"CAP"</span>, <span class="co"># indicating 'subset'</span></span>
<span>  <span class="co"># path = file.path("scenarios", glue("CAP_r{nreg}_debug")),</span></span>
<span>  <span class="co"># here we can add policy objects</span></span>
<span>  <span class="co"># STG_BTR_daily, # Battery, modeled with daily cycle for sampled calendar</span></span>
<span>  <span class="va">CO2_CAP</span>,</span>
<span>  <span class="va">ideea_modules</span><span class="op">$</span><span class="va">calendars</span><span class="op">$</span><span class="va">horizon_2060</span></span>
<span>  <span class="co"># horizon_2050</span></span>
<span>  <span class="co"># partial_calendar # add partial calendar to the interpolate function</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">scen_CAP</span><span class="op">@</span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/ideea_scenarios.html">ideea_scenarios</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/ideea_scenario_dir_name.html">ideea_scenario_dir_name</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"CAP"</span>, </span>
<span>    model_name <span class="op">=</span> <span class="va">mod</span><span class="op">@</span><span class="va">name</span>, </span>
<span>    calendar_name <span class="op">=</span> <span class="st">"d365_h24"</span>, </span>
<span>    horizon_name <span class="op">=</span> <span class="st">"2060"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scen_CAP</span><span class="op">@</span><span class="va">path</span></span>
<span></span>
<span><span class="va">scen_CAP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/write.html" class="external-link">write_sc</a></span><span class="op">(</span></span>
<span>  <span class="va">scen_CAP</span>,</span>
<span>  solver <span class="op">=</span> <span class="va">solver_options</span><span class="op">$</span><span class="va">gams_gdx_cplex_barrier</span></span>
<span>  <span class="co"># solver = solver_options$gams_gdx_cplex_parallel</span></span>
<span>  <span class="co"># solver = solver_options$pyomo_glpk</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_barrier</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_simplex</span></span>
<span>  <span class="co"># solver = solver_options$julia_highs_parallel</span></span>
<span><span class="op">)</span></span>
<span><span class="va">scen_CAP</span></span>
<span><span class="co"># scen_CAP@misc$tmp.dir &lt;- NULL</span></span>
<span></span>
<span><span class="fu"><a href="https://energyRt.org/reference/solve.html" class="external-link">solve_scenario</a></span><span class="op">(</span><span class="va">scen_CAP</span>, wait <span class="op">=</span> <span class="cn">F</span>, force <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">scen_CAP</span> <span class="op">&lt;-</span> <span class="fu">read</span><span class="op">(</span><span class="va">scen_CAP</span><span class="op">)</span></span>
<span><span class="co"># scen_CAP &lt;- solve(scen_CAP, wait = T, tmp.del = F)</span></span>
<span></span>
<span><span class="co"># store scenario on disk (unload from RAM)</span></span>
<span><span class="va">scen_CAP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/save_scenario.html" class="external-link">save_scenario</a></span><span class="op">(</span><span class="va">scen_CAP</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scen_CAP</span><span class="op">)</span></span>
<span><span class="co"># installr::os.sleep()</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<div class="section level3">
<h3 id="compare-scenarios">Compare scenarios<a class="anchor" aria-label="anchor" href="#compare-scenarios"></a>
</h3>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a list of</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="co"># scen_REF,</span></span>
<span>  <span class="va">scen_CAP</span></span>
<span>  <span class="co"># scen_REF_sub</span></span>
<span>  <span class="co"># scen_CAP_sub</span></span>
<span>  <span class="co"># .scen$CAP_sub,</span></span>
<span>  <span class="co"># .scen$REF_sub</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compare objective (in cr.₹)</span></span>
<span><span class="fu"><a href="https://energyRt.org/reference/getData.html" class="external-link">getData</a></span><span class="op">(</span><span class="va">sns</span>, <span class="st">"vObjective"</span>, merge <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># use `?getData` for help</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://energyRt.org/reference/getData.html" class="external-link">getData</a></span><span class="op">(</span><span class="va">sns</span>, <span class="st">"vBalance"</span>, comm <span class="op">=</span> <span class="st">"CO2"</span>, merge <span class="op">=</span> <span class="cn">T</span>, digits <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        drop.zeros <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># group_by(name, year) |&gt; </span></span>
<span>  <span class="co"># summarize(GWh = sum(value)) |&gt; </span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">scenario</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="total-installed-capacity">Total installed capacity<a class="anchor" aria-label="anchor" href="#total-installed-capacity"></a>
</h4>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compare generating tech capacity (names start with "E")</span></span>
<span><span class="va">vTechCap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/getData.html" class="external-link">getData</a></span><span class="op">(</span><span class="va">sns</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"vTechCap"</span>, tech_ <span class="op">=</span> <span class="st">"^E"</span>, process <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  merge <span class="op">=</span> <span class="cn">T</span>, digits <span class="op">=</span> <span class="fl">3</span>, drop.zeros <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vTechCap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># getData(scen_CAP_sub, "vImportRow", imp = "UNSERVED",</span></span>
<span><span class="co">#         digits = 1, drop.zeros = T, merge = T) |&gt; </span></span>
<span><span class="co">#   group_by(name, comm) |&gt; </span></span>
<span><span class="co">#   summarize(GWh = sum(value))</span></span>
<span></span>
<span><span class="fu"><a href="https://energyRt.org/reference/getData.html" class="external-link">getData</a></span><span class="op">(</span><span class="va">sns</span>, <span class="st">"pDemand"</span>, digits <span class="op">=</span> <span class="fl">1</span>, drop.zeros <span class="op">=</span> <span class="cn">T</span>, merge <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">scenario</span>, <span class="va">name</span>, <span class="va">comm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>GWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="total-capacity-map">Total capacity map<a class="anchor" aria-label="anchor" href="#total-capacity-map"></a>
</h4>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vTechCap_agg</span> <span class="op">&lt;-</span> <span class="va">vTechCap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/drop_process_cluster.html">drop_process_cluster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/drop_process_vintage.html">drop_process_vintage</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">scenario</span>, <span class="va">process</span>, <span class="va">region</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>GW <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">ideea_sf</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">regN_off</span><span class="op">)</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"many-to-many"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">process</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># filter(year %in% c(2020, 2035, 2060)) |&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ideea_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">GW</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vTechCap_agg</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span>, transform <span class="op">=</span> <span class="st">"sqrt"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># scale_fill_viridis_c(option = "C", transform = "log10") +</span></span>
<span>  <span class="co"># facet_grid(process~scenario) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">~</span><span class="va">process</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_ideea_map.html">theme_ideea_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vTechCap_agg</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">scenario</span>, <span class="va">process</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>GW <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">GW</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">scenario</span>, values_from <span class="op">=</span> <span class="va">GW</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="solar-capacity-by-cluster">Solar capacity by cluster<a class="anchor" aria-label="anchor" href="#solar-capacity-by-cluster"></a>
</h4>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">add_cluster_column</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">col_name</span> <span class="op">=</span> <span class="st">"process"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">col_name</span><span class="op">)</span>, <span class="st">"[0-9]+$"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .after <span class="op">=</span> <span class="va">col_name</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">vTechCap_ESOL_sf</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">vTechCap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"ESOL"</span>, <span class="va">process</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># select solar techs</span></span>
<span>  <span class="fu">add_cluster_column</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># add cluster number</span></span>
<span>  <span class="co"># add shapes for every cluster</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">ideea_sol_cl_sf</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">regN_off</span>, cluster <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"many-to-many"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>GW <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">GW</span><span class="op">)</span>, <span class="va">GW</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># filter(year %in% c(2020, 2035, 2060)) |&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># force to treat 'geometry' column as shape-data</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ideea_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">GW</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vTechCap_ESOL_sf</span>, color <span class="op">=</span> <span class="cn">NA</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># scale_fill_viridis_c(option = "H") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"C"</span>, transform <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">year</span> <span class="op">~</span> <span class="va">scenario</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_ideea_map.html">theme_ideea_map</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="wind-capacity-by-cluster">Wind capacity by cluster<a class="anchor" aria-label="anchor" href="#wind-capacity-by-cluster"></a>
</h4>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vTechCap_EWIN_sf</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">vTechCap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"EWIN"</span>, <span class="va">process</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># select solar techs</span></span>
<span>  <span class="fu">add_cluster_column</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># add cluster number</span></span>
<span>  <span class="co"># add shapes for every cluster</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">ideea_win_cl_sf</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">regN_off</span>, cluster <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"many-to-many"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>GW <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">GW</span><span class="op">)</span>, <span class="va">GW</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># filter(year %in% c(2020, 2035, 2060)) |&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># force to treat 'geometry' column as shape-data</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ideea_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">GW</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vTechCap_EWIN_sf</span>, color <span class="op">=</span> <span class="cn">NA</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"D"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># scale_fill_viridis_c(option = "D", transform = "log10") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">year</span> <span class="op">~</span> <span class="va">scenario</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_ideea_map.html">theme_ideea_map</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="network">Network<a class="anchor" aria-label="anchor" href="#network"></a>
</h4>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vTradeCap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/getData.html" class="external-link">getData</a></span><span class="op">(</span><span class="va">sns</span>, <span class="st">"vTradeCap"</span>, merge <span class="op">=</span> <span class="cn">T</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vTradeCap_HVAC</span> <span class="op">&lt;-</span> <span class="va">vTradeCap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"HVAC"</span>, <span class="va">trade</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">vTradeCap_HVDC</span> <span class="op">&lt;-</span> <span class="va">vTradeCap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"HVDC"</span>, <span class="va">trade</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b_ac</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"lon"</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"lat"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">network</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"region"</span> <span class="op">=</span> <span class="st">"region.x"</span>, </span>
<span>                            dst <span class="op">=</span> <span class="st">"region.y"</span>,</span>
<span>                            <span class="st">"case"</span> <span class="op">=</span> <span class="st">"case"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># left_join(filter(vTradeCap, year %in% max(vTradeCap$year)),</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">vTradeCap</span>, </span>
<span>            by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trd_name_ac"</span> <span class="op">=</span> <span class="st">"trade"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    type <span class="op">=</span> <span class="st">"HVAC"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">b_dc</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"lon"</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"lat"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">network</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"region"</span> <span class="op">=</span> <span class="st">"region.x"</span>, </span>
<span>                            dst <span class="op">=</span> <span class="st">"region.y"</span>,</span>
<span>                            <span class="st">"case"</span> <span class="op">=</span> <span class="st">"case"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># left_join(filter(vTradeCap, year %in% max(vTradeCap$year)),</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">vTradeCap</span>, </span>
<span>            by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trd_name_dc"</span> <span class="op">=</span> <span class="st">"trade"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    type <span class="op">=</span> <span class="st">"HVDC"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">b_ac</span>, <span class="va">b_dc</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ideea_sf</span>, fill <span class="op">=</span> <span class="st">"wheat"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">lon.x</span>, y <span class="op">=</span> <span class="va">lat.x</span>, xend <span class="op">=</span> <span class="va">lon.y</span>, yend <span class="op">=</span> <span class="va">lat.y</span>,</span>
<span>      linewidth <span class="op">=</span> <span class="va">value</span></span>
<span>    <span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"dodgerblue"</span>, lineend <span class="op">=</span> <span class="st">"round"</span>, alpha <span class="op">=</span> <span class="fl">.75</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">b</span>, <span class="va">value</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># geom_segment(aes(x = lon.x, y = lat.x, xend = lon.y, yend = lat.y),</span></span>
<span>  <span class="co">#   color = alpha("white", .5), lineend = "round",</span></span>
<span>  <span class="co">#   data = filter(a, case == "new")</span></span>
<span>  <span class="co"># ) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">points_coord</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">year</span><span class="op">~</span><span class="va">type</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GW"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_ideea_map.html">theme_ideea_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"tmp/network.png"</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">4</span>, scale <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="dc-converter-stations">DC converter stations<a class="anchor" aria-label="anchor" href="#dc-converter-stations"></a>
</h4>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vTechCap_DC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/getData.html" class="external-link">getData</a></span><span class="op">(</span><span class="va">sns</span>, <span class="st">"vTechCap"</span>, tech_ <span class="op">=</span> <span class="st">"ELC2EDC|EDC2ELC"</span>, </span>
<span>                       merge <span class="op">=</span> <span class="cn">T</span>, digits <span class="op">=</span> <span class="fl">1</span>, process <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vTechCap_DC_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://energyRt.org/reference/getData.html" class="external-link">getData</a></span><span class="op">(</span><span class="va">sns</span>, <span class="st">"vTechCap"</span>, tech_ <span class="op">=</span> <span class="st">"ELC2EDC|EDC2ELC"</span>, </span>
<span>                          merge <span class="op">=</span> <span class="cn">T</span>, digits <span class="op">=</span> <span class="fl">1</span>, process <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># drop_process_cluster() |&gt;</span></span>
<span>  <span class="fu"><a href="../reference/drop_process_vintage.html">drop_process_vintage</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">scenario</span>, <span class="va">process</span>, <span class="va">region</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>GW <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">GW</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">ideea_sf</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">regN_off</span><span class="op">)</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"many-to-many"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">process</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># filter(year %in% c(2020, 2035, 2060)) |&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">vTechCap_DC_sf</span><span class="op">$</span><span class="va">GW</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ideea_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">GW</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span>, </span>
<span>          data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">vTechCap_DC_sf</span>, <span class="va">GW</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"D"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># scale_fill_viridis_c(option = "C", transform = "log10") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">~</span><span class="va">process</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet_wrap(scenario~process) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"HVAC/HVDC converter stations"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"EDC2ELC - electricity import, ELC2EDC - export"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_ideea_map.html">theme_ideea_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"tmp/DC_converter_stations.png"</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">4</span>, </span>
<span>       scale <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="unserved">Unserved<a class="anchor" aria-label="anchor" href="#unserved"></a>
</h4>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://energyRt.org/reference/getData.html" class="external-link">getData</a></span><span class="op">(</span><span class="va">sns</span>, <span class="st">"vImportRow"</span>, comm <span class="op">=</span> <span class="st">"ELC"</span>, drop.zeros <span class="op">=</span> <span class="cn">T</span>, merge <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> </span>
<span>  <span class="co"># group_by(name, comm) |&gt; </span></span>
<span>  <span class="co"># summarize(GWh = sum(value))</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by IDEEA comunity.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
